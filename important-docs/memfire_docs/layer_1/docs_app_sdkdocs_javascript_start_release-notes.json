{
  "url": "https://docs.memfiredb.com/docs/app/sdkdocs/javascript/start/release-notes/",
  "title": "版本说明 | MemFire Cloud在线文档",
  "depth": 1,
  "timestamp": "2025-08-12 17:45:41",
  "html": "<main class=\"page-content bg-transparent\">\n<div class=\"top-header d-print-none\" id=\"top-header\">\n<div class=\"header-bar d-flex justify-content-between\">\n<div class=\"d-flex align-items-center\">\n<a alt=\"HomePage\" aria-label=\"HomePage\" class=\"logo-icon me-3\" href=\"/\">\n<div class=\"small\">\n<!--?xml version=\"1.0\" encoding=\"UTF-8\"?-->\n<svg height=\"112px\" version=\"1.1\" viewbox=\"0 0 99 112\" width=\"99px\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<title>MemFireDB备份 6</title>\n<defs>\n<lineargradient id=\"linearGradient-1\" x1=\"49.9999885%\" x2=\"49.9999885%\" y1=\"98.082503%\" y2=\"0.766550128%\">\n<stop offset=\"0%\" stop-color=\"#ED1C23\"></stop>\n<stop offset=\"100%\" stop-color=\"#FBAF3B\"></stop>\n</lineargradient>\n</defs>\n<g fill=\"none\" fill-rule=\"evenodd\" id=\"定稿\" stroke=\"none\" stroke-width=\"1\">\n<g id=\"MemFireDB备份-6\">\n<polygon fill=\"#F9AE7C\" id=\"Fill-1\" points=\"25.9728553 40.7912363 47.4268317 0.00591833831 1.15453123 26.7215251\"></polygon>\n<polygon fill=\"#F9AE7C\" id=\"Fill-3\" points=\"97.4213117 26.7267606 51.1285247 0.000910513587 72.4242993 40.8351686\"></polygon>\n<polygon fill=\"#F9904A\" id=\"Fill-5\" points=\"24.8347133 42.7618153 0.000455256793 28.682999 0.000455256793 82.1608764\"></polygon>\n<polygon fill=\"url(#linearGradient-1)\" id=\"Fill-7\" points=\"27.6634514 42.4662399 49.279044 109.05096 70.7296059 42.507213 49.2779058 1.3747617\"></polygon>\n<polygon fill=\"#F9904A\" id=\"Fill-9\" points=\"98.5660549 28.6951771 73.5622137 42.8047233 98.5660549 82.1719163\"></polygon>\n<polygon fill=\"#FB6D33\" id=\"Fill-13\" points=\"72.2987623 45.061545 50.7514582 111.900071 97.579172 84.8646465\"></polygon>\n<polygon fill=\"#FB6D33\" id=\"Fill-15\" points=\"26.1006687 45.0226206 0.987565799 84.8644188 47.8095888 111.898705\"></polygon>\n<path d=\"M60.0737516,38.507213 C59.3168872,35.669825 57.0462939,33.3514298 57.0462939,33.3514298 C57.0462939,33.3514298 57.0804382,35.8849338 56.2894295,37.513615 C55.4847631,39.1696116 53.8765685,40.3054773 53.8765685,40.3054773 C53.8765685,40.3054773 56.1016361,33.8840802 54.2715038,30.1247973 C52.0259496,25.5073552 49.1771803,23.3357803 49.1771803,23.3357803 C49.1771803,23.3357803 50.1070423,28.1319107 48.6240432,31.5065016 C47.1672215,34.8264618 42.8058614,36.7260208 40.7241997,38.7132167 C39.1865699,40.1791435 38.0814341,43.0711623 37.6068289,44.4847347 C37.5715465,44.5883056 37.560165,44.6918765 37.5533362,44.7943093 C37.584066,43.9816759 37.8890881,39.8024186 40.9654858,37.4293925 C43.8404325,35.2111538 41.2431925,30.3478731 41.2431925,30.3478731 C41.2431925,30.3478731 41.7212121,32.5638355 40.9939394,34.1401622 C40.2655285,35.7153507 38.7187936,36.5962726 38.0154218,38.259098 C37.3883056,39.7409589 37.5203301,44.1432921 37.5453692,44.8409731 C37.5453692,44.8591834 37.5476455,44.8762555 37.5476455,44.8921895 C37.5476455,44.9263338 37.5487836,44.9456822 37.5487836,44.9456822 L37.5487836,44.9115379 C37.5590269,45.2655001 37.7138142,45.6080808 37.9972116,45.8448143 L48.3713757,55.6442168 C48.8380139,56.0323232 49.5163466,56.0334614 49.9841229,55.6476312 L60.5938825,45.7105136 C60.9034571,45.4544316 61.0719021,45.0686015 61.0457249,44.6656992 C60.9546735,43.2282259 60.5699815,40.3692133 60.0737516,38.507213\" fill=\"#FFFFFF\" id=\"Fill-17\"></path>\n</g>\n</g>\n</svg>\n</div>\n<div class=\"big\">\n<svg height=\"20\" width=\"232\" xmlns=\"http://www.w3.org/2000/svg\"><defs><lineargradient id=\"a\" x1=\"50%\" x2=\"50%\" y1=\"98.083%\" y2=\".767%\"><stop offset=\"0%\" stop-color=\"#ED1C23\"></stop><stop offset=\"100%\" stop-color=\"#FBAF3B\"></stop></lineargradient></defs><g fill=\"none\" fill-rule=\"evenodd\"><path d=\"M78.622 12.384l1.596 21.94H77.49l-.847-14.154-8.98 15.523-4.899-15.53-4.416 14.162H55.6l7.085-21.871 5.712 17.174 10.224-17.244zm99.46.382l.324.01.454.036c.085.008.175.018.269.03l.61.096c1.09.203 2.518.644 3.883 1.596l.515.383-.46 3.694-.413-.62-.154-.195-.255-.285c-.765-.802-2.485-2.188-5.23-2.188-4.55 0-8.723 3.809-9.3 8.491-.287 2.311.334 4.469 1.755 6.077 1.342 1.517 3.257 2.354 5.39 2.354 2.606 0 4.58-1.225 5.606-2.04l.359-.3.424-.408.507-.552-.466 3.766-.093.06a12.622 12.622 0 01-4.577 1.842l-.629.1-.53.058-.418.027-.444.003c-2.918-.002-5.532-1.142-7.36-3.21-1.851-2.096-2.67-4.88-2.305-7.837.73-5.88 5.964-10.696 11.806-10.974l.732-.014zm18.174 9.018c1.724 0 3.344.713 4.443 1.956 1.101 1.248 1.59 2.88 1.377 4.596-.432 3.504-3.808 6.466-7.375 6.466-1.728 0-3.348-.715-4.45-1.96-1.096-1.242-1.583-2.864-1.377-4.563.44-3.52 3.818-6.495 7.382-6.495zm19.446.535l-1.486 12.02h-2.558l.16-1.292c-.936.93-2.462 1.755-4.173 1.755-1.318 0-2.48-.492-3.267-1.385-.804-.91-1.168-2.184-1.008-3.497l.9-7.274 2.597-.327-.914 7.402c-.101.785.084 1.466.525 1.968.49.552 1.27.845 2.25.845 1.526 0 3.3-1.155 3.51-2.873l.87-7.015 2.594-.327zm-63.587-.547c1.77 0 3.21.58 4.164 1.678 1.047 1.207 1.48 3.01 1.263 5.233l-.097.771h-9.914c.16 1.896 1.567 2.979 3.895 2.979 1.806 0 2.878-.434 3.868-.961l1.119-.623-.312 2.522-.106.06c-1.224.687-2.604 1.356-4.8 1.356-2.092 0-3.873-.708-5.006-1.992-.991-1.12-1.404-2.599-1.198-4.272.548-4.433 4.001-6.751 7.124-6.751zm-62.717 0c1.771 0 3.211.58 4.164 1.678 1.048 1.207 1.48 3.01 1.263 5.233l-.097.771h-9.914c.16 1.896 1.567 2.979 3.895 2.979 1.622 0 2.652-.35 3.563-.803l.594-.315.83-.466-.312 2.522-.105.06c-1.224.687-2.604 1.356-4.8 1.356-2.093 0-3.874-.708-5.007-1.992-.99-1.12-1.404-2.599-1.197-4.272.547-4.433 4-6.751 7.123-6.751zM231.476 12l-2.767 22.34h-2.556l.197-1.59c-1.104 1.191-2.882 2.021-4.471 2.021-1.781 0-3.24-.583-4.217-1.69-1.02-1.151-1.452-2.817-1.222-4.686.485-3.908 3.43-6.636 7.167-6.636 1.565 0 3.065.832 3.852 2.064l1.356-10.968 2.661-.855zm-42.07.002L186.64 34.34h-2.556l2.664-21.483 2.66-.854zm-56.632 1.268l-1.166 2.527h-9.586l-.85 6.867h6.627v.48h-.12l-.883 1.778v.24h-5.933l-1.138 9.163h-2.729l2.612-21.055h13.166zm2.715 9.038l-1.497 12.017h-2.559l1.455-11.722 2.601-.295zm-24.427-.537c1 0 1.93.427 2.616 1.204.84.95 1.224 2.29 1.053 3.677l-.955 7.673h-2.527l.922-7.445c.13-1.017-.027-1.81-.45-2.287-.326-.367-.815-.554-1.458-.554-1.954 0-3.178 1.346-3.332 2.613l-.955 7.673h-2.556l.922-7.445c.127-1.03-.024-1.826-.442-2.297-.319-.362-.801-.544-1.437-.544-1.522 0-3.3 1.166-3.516 2.901l-.912 7.385h-2.559l1.455-11.722 2.594-.295-.146 1.164c1.027-1.077 2.419-1.701 3.854-1.701 1.375 0 2.58.79 3.226 2.083.914-1.13 2.05-2.083 4.603-2.083zm29.487.532l-.206 1.73c1.082-.978 2.932-1.7 4.514-1.7h.269l-.271 2.282h-.214c-1.814 0-4.469.837-4.7 2.7l-.866 7.01h-2.558l1.45-11.693 2.582-.329zm55.47 1.865c-2.31 0-4.27 1.792-4.563 4.168-.144 1.145.15 2.196.824 2.957.64.725 1.586 1.126 2.656 1.126 2.292 0 4.241-1.78 4.532-4.14.146-1.169-.144-2.237-.821-3.003-.634-.715-1.567-1.108-2.628-1.108zm27.497-.029c-2.278 0-4.15 1.752-4.45 4.17-.149 1.187.137 2.255.8 3.006.611.692 1.526 1.076 2.57 1.076 2.294 0 4.173-1.743 4.468-4.143.152-1.21-.13-2.285-.79-3.033-.623-.704-1.52-1.076-2.598-1.076zm-134.356.045c-1.89 0-3.372 1.094-4.015 2.947h7.164a2.853 2.853 0 00-.71-1.956c-.574-.648-1.416-.991-2.439-.991zm62.715 0c-1.892 0-3.37 1.094-4.013 2.947h7.166a2.867 2.867 0 00-.713-1.956c-.573-.648-1.416-.991-2.44-.991zm-17.267-7.614c.919 0 1.706.748 1.754 1.668a1.587 1.587 0 01-1.603 1.692c-.917 0-1.704-.75-1.754-1.668a1.593 1.593 0 011.603-1.692z\" fill=\"#116\"></path><path d=\"M11.131 17.482L20.326.002.495 11.453zm30.621-6.028L21.912 0l9.127 17.5z\" fill=\"#F9AE7C\"></path><path d=\"M10.643 18.326L0 12.293v22.919z\" fill=\"#F9904A\"></path><path d=\"M11.856 18.2l9.264 28.536 9.193-28.519L21.119.59z\" fill=\"url(#a)\"></path><path d=\"M42.243 12.298l-10.716 6.047 10.716 16.872z\" fill=\"#F9904A\"></path><path d=\"M30.985 19.312l-9.234 28.645L41.82 36.371zm-19.799-.017L.423 36.37 20.49 47.957z\" fill=\"#FB6D33\"></path><path d=\"M25.746 16.503c-.324-1.216-1.298-2.21-1.298-2.21s.015 1.086-.324 1.784c-.345.71-1.034 1.197-1.034 1.197s.954-2.752.17-4.363c-.963-1.98-2.184-2.91-2.184-2.91s.398 2.056-.237 3.502c-.624 1.423-2.494 2.237-3.386 3.088-.659.629-1.132 1.868-1.336 2.474a.509.509 0 00-.023.133c.013-.349.144-2.14 1.463-3.157 1.232-.95.119-3.035.119-3.035s.205.95-.107 1.625c-.312.676-.975 1.053-1.277 1.766-.268.635-.212 2.522-.201 2.82v.023l.001.022v-.014a.54.54 0 00.193.4l4.446 4.2c.2.166.49.166.69.001l4.548-4.259a.535.535 0 00.193-.448c-.039-.616-.203-1.84-.416-2.639\" fill=\"#FFF\"></path></g></svg>\n</div>\n</a>\n<button class=\"btn btn-icon btn-soft\" id=\"close-sidebar\">\n<span class=\"material-icons size-20 menu-icon align-middle\">menu</span>\n</button>\n</div>\n<div class=\"d-flex align-items-center\">\n<ul class=\"list-unstyled mb-0\">\n</ul>\n<a class=\"btn btn-icon btn-default ms-4\" href=\"https://memfiredb.com/\" target=\"_blank\" type=\"button\">官网</a>\n<a class=\"btn btn-icon btn-default ms-4\" href=\"https://community.memfiredb.com/\" target=\"_blank\" type=\"button\">论坛</a>\n<a class=\"btn btn-icon btn-default ms-4\" href=\"https://cloud.memfiredb.com/auth/login\" target=\"_blank\" type=\"button\">登录</a>\n<button aria-label=\"Toggle user interface mode\" class=\"btn btn-icon btn-default ms-2\" id=\"mode\" type=\"button\">\n<span class=\"toggle-dark\">\n<svg fill=\"currentColor\" height=\"30\" viewbox=\"0 0 48 48\" width=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>Enable dark mode</title>\n<path d=\"M24 42q-7.5 0-12.75-5.25T6 24q0-7.5 5.25-12.75T24 6q.4 0 .85.025.45.025 1.15.075-1.8 1.6-2.8 3.95-1 2.35-1 4.95 0 4.5 3.15 7.65Q28.5 25.8 33 25.8q2.6 0 4.95-.925T41.9 22.3q.05.6.075.975Q42 23.65 42 24q0 7.5-5.25 12.75T24 42Zm0-3q5.45 0 9.5-3.375t5.05-7.925q-1.25.55-2.675.825Q34.45 28.8 33 28.8q-5.75 0-9.775-4.025T19.2 15q0-1.2.25-2.575.25-1.375.9-3.125-4.9 1.35-8.125 5.475Q9 18.9 9 24q0 6.25 4.375 10.625T24 39Zm-.2-14.85Z\"></path>\n</svg>\n</span>\n<span class=\"toggle-light\">\n<svg fill=\"currentColor\" height=\"30\" viewbox=\"0 0 48 48\" width=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>Enable light mode</title>\n<path d=\"M24 31q2.9 0 4.95-2.05Q31 26.9 31 24q0-2.9-2.05-4.95Q26.9 17 24 17q-2.9 0-4.95 2.05Q17 21.1 17 24q0 2.9 2.05 4.95Q21.1 31 24 31Zm0 3q-4.15 0-7.075-2.925T14 24q0-4.15 2.925-7.075T24 14q4.15 0 7.075 2.925T34 24q0 4.15-2.925 7.075T24 34ZM3.5 25.5q-.65 0-1.075-.425Q2 24.65 2 24q0-.65.425-1.075Q2.85 22.5 3.5 22.5h5q.65 0 1.075.425Q10 23.35 10 24q0 .65-.425 1.075-.425.425-1.075.425Zm36 0q-.65 0-1.075-.425Q38 24.65 38 24q0-.65.425-1.075.425-.425 1.075-.425h5q.65 0 1.075.425Q46 23.35 46 24q0 .65-.425 1.075-.425.425-1.075.425ZM24 10q-.65 0-1.075-.425Q22.5 9.15 22.5 8.5v-5q0-.65.425-1.075Q23.35 2 24 2q.65 0 1.075.425.425.425.425 1.075v5q0 .65-.425 1.075Q24.65 10 24 10Zm0 36q-.65 0-1.075-.425-.425-.425-.425-1.075v-5q0-.65.425-1.075Q23.35 38 24 38q.65 0 1.075.425.425.425.425 1.075v5q0 .65-.425 1.075Q24.65 46 24 46ZM12 14.1l-2.85-2.8q-.45-.45-.425-1.075.025-.625.425-1.075.45-.45 1.075-.45t1.075.45L14.1 12q.4.45.4 1.05 0 .6-.4 1-.4.45-1.025.45-.625 0-1.075-.4Zm24.7 24.75L33.9 36q-.4-.45-.4-1.075t.45-1.025q.4-.45 1-.45t1.05.45l2.85 2.8q.45.45.425 1.075-.025.625-.425 1.075-.45.45-1.075.45t-1.075-.45ZM33.9 14.1q-.45-.45-.45-1.05 0-.6.45-1.05l2.8-2.85q.45-.45 1.075-.425.625.025 1.075.425.45.45.45 1.075t-.45 1.075L36 14.1q-.4.4-1.025.4-.625 0-1.075-.4ZM9.15 38.85q-.45-.45-.45-1.075t.45-1.075L12 33.9q.45-.45 1.05-.45.6 0 1.05.45.45.45.45 1.05 0 .6-.45 1.05l-2.8 2.85q-.45.45-1.075.425-.625-.025-1.075-.425ZM24 24Z\"></path>\n</svg>\n</span>\n</button>\n</div>\n</div>\n</div>\n<div class=\"container-fluid\">\n<div class=\"layout-spacing\">\n<div class=\"d-md-flex justify-content-between align-items-center\"></div>\n<div class=\"row flex-xl-nowrap\">\n<div class=\"docs-toc col-xl-3 d-xl-block\"><toc>\n<div class=\"fw-bold text-uppercase mb-2\">本页</div>\n\n</toc></div>\n<div class=\"docs-toc-mobile d-print-none d-xl-none\">\n<button aria-expanded=\"false\" class=\"btn-secondary dropdown-toggle\" data-bs-offset=\"0,0\" data-bs-toggle=\"dropdown\" id=\"toc-dropdown-btn\" type=\"button\">明确的构造器选项</button>\n</div>\n<div class=\"docs-content col-12 col-xl-9 mt-0\">\n<div class=\"mb-0 d-flex\">\n<h1 class=\"content-title mb-0\">\n                                                    版本说明\n                                                    \n                                                </h1>\n</div>\n<div class=\"main-content\" data-bs-root-margin=\"0px 0px -65%\" data-bs-spy=\"scroll\" data-bs-target=\"#toc-mobile\" id=\"content\">\n<div data-prismjs-copy=\"\" data-prismjs-copy-error=\"\" data-prismjs-copy-success=\"\">\n<p>Supabase.js是Supabase数据库服务的官方JavaScript客户端库，用于与Supabase API进行交互。\n最新版本Supabase.js v2带来了一系列令人振奋的新特性、更新和改进，使开发者在构建现代Web应用程序时拥有更加强大和灵活的工具。</p>\n<p>让我们深入了解这些新功能，并看看它们如何改进您的Supabase体验！接下来，我们将逐步探索Supabase.js v2的亮点和特性，帮助您更好地了解这个新版本。</p>\n<p>首先需要用<code>npm install @supabase/supabase-js</code>安装最新版本。</p>\n<h3 id=\"明确的构造器选项\">明确的构造器选项 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e6%98%8e%e7%a1%ae%e7%9a%84%e6%9e%84%e9%80%a0%e5%99%a8%e9%80%89%e9%a1%b9\"><i class=\"material-icons align-middle\">link</i></a></h3><p>构造函数中的所有客户端特定选项都是键入库的。</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-jsx\" id=\"f869bae\" tabindex=\"0\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> supabase <span class=\"token operator\">=</span> <span class=\"token function\">createClient</span><span class=\"token punctuation\">(</span>apiURL<span class=\"token punctuation\">,</span> apiKey<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">db</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">schema</span><span class=\"token operator\">:</span> <span class=\"token string\">'public'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">auth</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">storage</span><span class=\"token operator\">:</span> AsyncStorage<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">autoRefreshToken</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">persistSession</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">detectSessionInUrl</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">realtime</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    channels<span class=\"token punctuation\">,</span>\n    endpoint<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">global</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">fetch</span><span class=\"token operator\">:</span> customFetch<span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token constant\">DEFAULT_HEADERS</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<h3 id=\"支持typescript\">支持typescript <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e6%94%af%e6%8c%81typescript\"><i class=\"material-icons align-middle\">link</i></a></h3><p>这些库现在支持typescript。</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-ts\" id=\"3157cd5\" tabindex=\"0\"><code class=\"language-ts\"><span class=\"token comment\">// v2 - definitions are injected in `createClient()`</span>\n<span class=\"token keyword\">import</span> <span class=\"token keyword\">type</span> <span class=\"token punctuation\">{</span> Database <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./DatabaseDefinitions'</span>\n<span class=\"token keyword\">const</span> supabase <span class=\"token operator\">=</span> <span class=\"token generic-function\"><span class=\"token function\">createClient</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>Database<span class=\"token operator\">&gt;</span></span></span><span class=\"token punctuation\">(</span><span class=\"token constant\">SUPABASE_URL</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">ANON_KEY</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> supabase<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'messages'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> id<span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// v1 -- previously definitions were injected in the `from()` method</span>\nsupabase<span class=\"token punctuation\">.</span><span class=\"token generic-function\"><span class=\"token function\">from</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>Definitions<span class=\"token punctuation\">[</span><span class=\"token string\">'Message'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">&gt;</span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">'messages'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>类型可以通过CLI生成。</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-bash\" id=\"2497b2c\" tabindex=\"0\"><code class=\"language-bash\">supabase start\nsupabase gen types typescript <span class=\"token parameter variable\">--local</span> <span class=\"token operator\">&gt;</span> DatabaseDefinitions.ts</code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<h3 id=\"数据操作返回最小值\">数据操作返回最小值 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e6%95%b0%e6%8d%ae%e6%93%8d%e4%bd%9c%e8%bf%94%e5%9b%9e%e6%9c%80%e5%b0%8f%e5%80%bc\"><i class=\"material-icons align-middle\">link</i></a></h3><p><code>.insert()</code> / <code>.upsert()</code> / <code>.update()</code> / <code>.delete()</code> 默认情况下不返回行:<a href=\"https://github.com/supabase/postgrest-js/pull/276\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>.</p>\n<p>以前，这些方法默认返回插入/更新/删除的行（这引起了<a href=\"https://github.com/supabase/supabase/discussions/1548\" rel=\"external\" target=\"_blank\">一些混乱<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>），你可以通过指定 “returning: ‘minimal’“选择不返回它。现在的默认行为是不返回记录。要返回插入/更新/删除的行，请在最后添加一个<code>.select()</code>的调用，例如：</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-sql\" id=\"083045d\" tabindex=\"0\"><code class=\"language-sql\">const { <span class=\"token keyword\">data</span><span class=\"token punctuation\">,</span> error } <span class=\"token operator\">=</span> await supabase\n  <span class=\"token punctuation\">.</span><span class=\"token keyword\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'my_table'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token keyword\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span>eq<span class=\"token punctuation\">(</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token keyword\">select</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<h3 id=\"新的排序默认值\">新的排序默认值 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e6%96%b0%e7%9a%84%e6%8e%92%e5%ba%8f%e9%bb%98%e8%ae%a4%e5%80%bc\"><i class=\"material-icons align-middle\">link</i></a></h3><p><code>.order()</code>现在默认为Postgres的默认值：<a href=\"https://github.com/supabase/postgrest-js/pull/283\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>。</p>\n<p>以前<code>nullsFirst</code>默认为<code>false</code>，这意味着<code>null</code>是最后排序的。这对性能是不利的，例如，如果该列使用<code>NULLS FIRST</code>的索引（这是索引的默认方向）。</p>\n<h3 id=\"cookies和localstorage命名空间\">Cookies和localstorage命名空间 <a aria-hidden=\"true\" class=\"anchor\" href=\"#cookies%e5%92%8clocalstorage%e5%91%bd%e5%90%8d%e7%a9%ba%e9%97%b4\"><i class=\"material-icons align-middle\">link</i></a></h3><p>Auth库中的存储密钥名称已经改变，包括项目参考，这意味着现有的网站如果将其JWT到期时间设置为较长的时间，可能会发现他们的用户在这次升级中被注销。</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-jsx\" id=\"d06b1f6\" tabindex=\"0\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> defaultStorageKey <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">sb-</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">URL</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>authUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>hostname<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">-auth-token</span><span class=\"token template-punctuation string\">`</span></span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<h3 id=\"新的授权类型\">新的授权类型 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e6%96%b0%e7%9a%84%e6%8e%88%e6%9d%83%e7%b1%bb%e5%9e%8b\"><i class=\"material-icons align-middle\">link</i></a></h3><p>类型化已经被重新设计。<code>Session</code>接口现在保证它总是有<code>access_token</code>, <code>refresh_token</code>和<code>user</code></p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-jsx\" id=\"3669a90\" tabindex=\"0\"><code class=\"language-jsx\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Session</span> <span class=\"token punctuation\">{</span>\n    provider_token<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span>\n    <span class=\"token literal-property property\">access_token</span><span class=\"token operator\">:</span> string\n    expires_in<span class=\"token operator\">?</span><span class=\"token operator\">:</span> number\n    expires_at<span class=\"token operator\">?</span><span class=\"token operator\">:</span> number\n    <span class=\"token literal-property property\">refresh_token</span><span class=\"token operator\">:</span> string\n    <span class=\"token literal-property property\">token_type</span><span class=\"token operator\">:</span> string\n    <span class=\"token literal-property property\">user</span><span class=\"token operator\">:</span> User\n<span class=\"token punctuation\">}</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<h3 id=\"新的认证方法\">新的认证方法 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e6%96%b0%e7%9a%84%e8%ae%a4%e8%af%81%e6%96%b9%e6%b3%95\"><i class=\"material-icons align-middle\">link</i></a></h3><p>我们将删除<code>signIn()</code>方法，改用更明确的函数签名。\n<code>signInWithPassword()</code>, <code>signInWithOtp()</code>, 和 <code>signInWithOtp()</code>.</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-ts\" id=\"15a1787\" tabindex=\"0\"><code class=\"language-ts\"><span class=\"token comment\">// v2</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> supabase<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span><span class=\"token function\">signInWithPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  email<span class=\"token operator\">:</span> <span class=\"token string\">'hello@example'</span><span class=\"token punctuation\">,</span>\n  password<span class=\"token operator\">:</span> <span class=\"token string\">'pass'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// v1</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> supabase<span class=\"token punctuation\">.</span>auth<span class=\"token punctuation\">.</span><span class=\"token function\">signIn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  email<span class=\"token operator\">:</span> <span class=\"token string\">'hello@example'</span><span class=\"token punctuation\">,</span>\n  password<span class=\"token operator\">:</span> <span class=\"token string\">'pass'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<h3 id=\"新的实时方法\">新的实时方法 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e6%96%b0%e7%9a%84%e5%ae%9e%e6%97%b6%e6%96%b9%e6%b3%95\"><i class=\"material-icons align-middle\">link</i></a></h3><p>在Realtime库中有一个新的<code>channel()</code>方法，它将被用于我们的多人游戏更新。</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-ts\" id=\"6ff2464\" tabindex=\"0\"><code class=\"language-ts\">supabase\n  <span class=\"token punctuation\">.</span><span class=\"token function\">channel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'any_string_you_want'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'presence'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> event<span class=\"token operator\">:</span> <span class=\"token string\">'track'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nsupabase\n  <span class=\"token punctuation\">.</span><span class=\"token function\">channel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'any_string_you_want'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'postgres_changes'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      event<span class=\"token operator\">:</span> <span class=\"token string\">'INSERT'</span><span class=\"token punctuation\">,</span>\n      schema<span class=\"token operator\">:</span> <span class=\"token string\">'public'</span><span class=\"token punctuation\">,</span>\n      table<span class=\"token operator\">:</span> <span class=\"token string\">'movies'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>payload<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>我们将废弃以前用于监听postgres变化的`.from().on().subscribe()‘方法。</p>\n<h3 id=\"废弃的setauth\">废弃的setAuth() <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e5%ba%9f%e5%bc%83%e7%9a%84setauth\"><i class=\"material-icons align-middle\">link</i></a></h3><p>废弃并删除了<code>setAuth()</code>。要设置一个自定义的<code>access_token</code> jwt，请将自定义的头信息传入提供的<code>createClient()</code>方法：(<a href=\"https://github.com/supabase/gotrue-js/pull/340\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</p>\n<h3 id=\"所有变化\">所有变化 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e6%89%80%e6%9c%89%e5%8f%98%e5%8c%96\"><i class=\"material-icons align-middle\">link</i></a></h3><ul>\n<li><code>supabase-js</code>\n<ul>\n<li><code>shouldThrowOnError</code>已被删除，直到所有客户端库都支持该选项（<a href=\"https://github.com/supabase/supabase-js/pull/490\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>）。</li>\n</ul>\n</li>\n<li><code>postgrest-js</code>\n<ul>\n<li>TypeScript的类型已被重新设计 <a href=\"https://github.com/supabase/postgrest-js/pull/279\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a></li>\n<li>对函数参数、类型等使用<code>undefined</code>而不是<code>null</code>(<a href=\"https://github.com/supabase/postgrest-js/pull/278\" rel=\"external\" target=\"_blank\">https://github.com/supabase/postgrest-js/pull/278<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li>一些功能现在已经过时了：(<a href=\"https://github.com/supabase/postgrest-js/pull/275\" rel=\"external\" target=\"_blank\">https://github.com/supabase/postgrest-js/pull/275<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)\n<ul>\n<li>过滤器缩写（例如：<code>cs</code>与<code>contains</code>）。</li>\n<li>响应中的 “body”（相对于 “data”）。</li>\n<li>通过”.insert() “方法进行 “上载”。</li>\n<li><code>PostgrestClient</code>上的<code>auth</code>方法</li>\n<li>客户端级别的`throwOnError’方法</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><code>Gotrue-js</code>\n<ul>\n<li><code>supase-js</code>客户端允许传递一个<code>storageKey</code>参数，这将允许用户设置本地存储中用于存储会话的密钥。默认情况下，这将与supabase项目参考文献一起被命名为空间。(<a href=\"https://github.com/supabase/supabase-js/pull/460\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li><code>signIn</code>方法现在分为<code>signInWithPassword</code>, <code>signInWithOtp</code>, <code>signInWithOAuth</code> (<a href=\"https://github.com/supabase/gotrue-js/pull/304\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li>弃用并删除了<code>session()</code>, <code>user()</code>，改用<code>getSession()</code>。如果用户已经登录，<code>getSession()</code>将总是返回一个有效的会话，这意味着不再有随机注销。(<a href=\"https://github.com/supabase/gotrue-js/pull/299\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li>废弃并删除了对<code>multitab'支持的设置，因为</code>getSession()`和gotrue的重用间隔设置已经处理了多个标签的会话管理(<a href=\"https://github.com/supabase/gotrue-js/pull/366\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li>不再抛出随机错误，gotrue-js v2总是返回一个自定义的错误类型：(<a href=\"https://github.com/supabase/gotrue-js/pull/341\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)\n<ul>\n<li><code>AuthSessionMissingError</code>(AuthSession错误)\n<ul>\n<li>表示预期有一个会话，但没有。</li>\n</ul>\n</li>\n<li><code>AuthNoCookieError</code>表示预期有cookie，但没有。\n<ul>\n<li>表示期望有一个cookie，但没有。</li>\n</ul>\n</li>\n<li><code>AuthInvalidCredentialsError</code>表示期望有一个cookie但没有。\n<ul>\n<li>表示传递了不正确的凭证。</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>将 “api “命名空间更名为 “admin”，“admin “命名空间将只包含只能在受信任的服务器端环境中使用的方法，并配有服务角色密钥</li>\n<li>将<code>resetPasswordForEmail</code>、<code>getUser</code>和<code>updateUser</code>移至<code>GoTrueClient</code>，这意味着它们可以从<code>supabase.auth</code>命名空间访问<code>supabase-js</code>，而不是通过<code>supabase.auth.api</code>来访问它们。</li>\n<li>删除了<code>sendMobileOTP</code>, <code>sendMagicLinkEmail</code>，改用<code>signInWithOtp</code>。</li>\n<li>删除了<code>signInWithEmail</code>, <code>signInWithPhone</code>，改为<code>signInWithPassword</code>。</li>\n<li>删除了 “用电子邮件签名”、“用电话签名”，改为 “签名”。</li>\n<li>用 “updateUser “代替了 “update”。</li>\n</ul>\n</li>\n<li><code>Storage-js</code>。\n<ul>\n<li>返回类型更加严格。函数类型曾经表明，即使没有错误，返回的数据也可能是空的。现在我们使用联合类型，只有在出现错误时才将数据标记为空，反之亦然。(<a href=\"https://github.com/supabase/storage-js/pull/60\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li><code>upload</code>和<code>update</code>函数返回上传对象的路径作为<code>path</code>参数。以前的返回值是将桶的名称预置在路径上，这使得该值难以传递给其他storage-js方法，因为所有的方法都是单独获取桶的名称和路径。我们还选择将返回值称为<code>path</code>而不是<code>Key</code>(<a href=\"https://github.com/supabase/storage-js/pull/75\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li><code>getPublicURL</code>只返回数据对象中的公共URL。这与我们的其他方法保持一致，只在数据对象内返回。没有错误返回，因为这个方法不能抛出一个错误(<a href=\"https://github.com/supabase/storage-js/pull/93\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li>在<code>createSignedUrl'和</code>createSignedUrls’中，签名的URL将以<code>signedUrl'而不是</code>signedURL’返回(<a href=\"https://github.com/supabase/storage-js/pull/94\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li>对<code>createSignedUrl</code>、<code>createSignedUrls</code>和<code>getPublicUrl</code>返回的URL进行编码(<a href=\"https://github.com/supabase/storage-js/pull/86\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li><code>createsignedUrl</code>曾经直接返回一个URL，并在数据对象中。这是不一致的。现在我们在所有方法中都只返回数据对象中的值。(<a href=\"https://www.notion.so/LW5-supabase-js-v2-7b0bfcdf571d4f20b9b7a9308883f24b\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li><code>createBucket</code>返回一个数据对象，而不是直接返回桶的名字。(<a href=\"https://github.com/supabase/storage-js/pull/89\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li>固定了元数据的类型 (<a href=\"https://github.com/supabase/storage-js/pull/90\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)</li>\n<li>更好的错误类型使其更容易快速追踪到出错的原因。</li>\n<li><code>SupabaseStorageClient</code>不再被导出。使用 “StorageClient “代替。(<a href=\"https://github.com/supabase/storage-js/pull/92\" rel=\"external\" target=\"_blank\">PR<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a>)。</li>\n</ul>\n</li>\n<li><code>Realtime-js</code>。\n<ul>\n<li><code>RealtimeSubscription</code>类不再存在，被<code>RealtimeChannel</code>取代。</li>\n<li><code>RealtimeClient</code>的<code>disconnect</code>方法现在返回类型为<code>void</code>。以前它返回的类型是<code>Promise&lt;{ error: Error | null; data: boolean }</code>。</li>\n<li>从<code>SupabaseClient</code>类中删除了<code>removeAllSubscriptions</code>和<code>removeSubscription</code>方法。</li>\n<li>删除了 “SupabaseRealtimeClient “类。</li>\n<li>删除了 “SupabaseQueryBuilder “类。</li>\n<li>删除了 “SupabaseEventTypes “类型。\n<ul>\n<li>考虑将其重命名为 “RealtimePostgresChangeEvents”，并将其移至 “realtime-js “版本。</li>\n</ul>\n</li>\n<li>删除了<code>.from('table').on('INSERT', () ⇒ {}).subscribe()</code>，以支持新的实时客户端API。</li>\n</ul>\n</li>\n</ul>\n</div>\n</div>\n<div><hr class=\"doc-hr\"/>\n<div class=\"d-print-none\" id=\"doc-nav\">\n<div class=\"row flex-xl-nowrap\">\n<div class=\"col-sm-6 pt-2 doc-next\">\n<a href=\"/docs/app/sdkdocs/javascript/start/typescript-support/\">\n<div class=\"card h-100 my-1\">\n<div class=\"card-body py-2\">\n<p class=\"card-title fs-5 fw-semibold lh-base mb-0\"><i class=\"material-icons align-middle\">navigate_before</i> 支持Typescript</p>\n</div>\n</div>\n</a>\n</div>\n<div class=\"col-sm-6 pt-2 doc-prev\">\n<a class=\"ms-auto\" href=\"/docs/app/sdkdocs/javascript/database/select/\">\n<div class=\"card h-100 my-1 text-end\">\n<div class=\"card-body py-2\">\n<p class=\"card-title fs-5 fw-semibold lh-base mb-0\">Select 查询 <i class=\"material-icons align-middle\">navigate_next</i></p>\n</div>\n</div>\n</a>\n</div>\n</div>\n</div></div>\n</div>\n</div>\n</div>\n</div>\n\n</main>",
  "markdown": "[MemFireDB备份 6](/)\n\nmenu\n\n[官网](https://memfiredb.com/)\n[论坛](https://community.memfiredb.com/)\n[登录](https://cloud.memfiredb.com/auth/login)\n\nEnable dark mode\n\nEnable light mode\n\n本页\n\n明确的构造器选项\n\n# 版本说明\n\nSupabase.js是Supabase数据库服务的官方JavaScript客户端库，用于与Supabase API进行交互。\n最新版本Supabase.js v2带来了一系列令人振奋的新特性、更新和改进，使开发者在构建现代Web应用程序时拥有更加强大和灵活的工具。\n\n让我们深入了解这些新功能，并看看它们如何改进您的Supabase体验！接下来，我们将逐步探索Supabase.js v2的亮点和特性，帮助您更好地了解这个新版本。\n\n首先需要用`npm install @supabase/supabase-js`安装最新版本。\n\n### 明确的构造器选项 [*link*](#%e6%98%8e%e7%a1%ae%e7%9a%84%e6%9e%84%e9%80%a0%e5%99%a8%e9%80%89%e9%a1%b9)\n\n构造函数中的所有客户端特定选项都是键入库的。\n\n```\nconst supabase = createClient(apiURL, apiKey, {\n  db: {\n    schema: 'public',\n  },\n  auth: {\n    storage: AsyncStorage,\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: true,\n  },\n  realtime: {\n    channels,\n    endpoint,\n  },\n  global: {\n    fetch: customFetch,\n    headers: DEFAULT_HEADERS,\n  },\n})\n```\n\n### 支持typescript [*link*](#%e6%94%af%e6%8c%81typescript)\n\n这些库现在支持typescript。\n\n```\n// v2 - definitions are injected in `createClient()`\nimport type { Database } from './DatabaseDefinitions'\nconst supabase = createClient<Database>(SUPABASE_URL, ANON_KEY)\nconst { data } = await supabase.from('messages').select().match({ id: 1 })\n\n// v1 -- previously definitions were injected in the `from()` method\nsupabase.from<Definitions['Message']>('messages').select('*')\n```\n\n类型可以通过CLI生成。\n\n```\nsupabase start\nsupabase gen types typescript --local > DatabaseDefinitions.ts\n```\n\n### 数据操作返回最小值 [*link*](#%e6%95%b0%e6%8d%ae%e6%93%8d%e4%bd%9c%e8%bf%94%e5%9b%9e%e6%9c%80%e5%b0%8f%e5%80%bc)\n\n`.insert()` / `.upsert()` / `.update()` / `.delete()` 默认情况下不返回行:[PR](https://github.com/supabase/postgrest-js/pull/276).\n\n以前，这些方法默认返回插入/更新/删除的行（这引起了[一些混乱](https://github.com/supabase/supabase/discussions/1548)），你可以通过指定 “returning: ‘minimal’“选择不返回它。现在的默认行为是不返回记录。要返回插入/更新/删除的行，请在最后添加一个`.select()`的调用，例如：\n\n```\nconst { data, error } = await supabase\n  .from('my_table')\n  .delete()\n  .eq('id', 1)\n  .select()\n```\n\n### 新的排序默认值 [*link*](#%e6%96%b0%e7%9a%84%e6%8e%92%e5%ba%8f%e9%bb%98%e8%ae%a4%e5%80%bc)\n\n`.order()`现在默认为Postgres的默认值：[PR](https://github.com/supabase/postgrest-js/pull/283)。\n\n以前`nullsFirst`默认为`false`，这意味着`null`是最后排序的。这对性能是不利的，例如，如果该列使用`NULLS FIRST`的索引（这是索引的默认方向）。\n\n### Cookies和localstorage命名空间 [*link*](#cookies%e5%92%8clocalstorage%e5%91%bd%e5%90%8d%e7%a9%ba%e9%97%b4)\n\nAuth库中的存储密钥名称已经改变，包括项目参考，这意味着现有的网站如果将其JWT到期时间设置为较长的时间，可能会发现他们的用户在这次升级中被注销。\n\n```\nconst defaultStorageKey = `sb-${new URL(this.authUrl).hostname.split('.')[0]}-auth-token`\n```\n\n### 新的授权类型 [*link*](#%e6%96%b0%e7%9a%84%e6%8e%88%e6%9d%83%e7%b1%bb%e5%9e%8b)\n\n类型化已经被重新设计。`Session`接口现在保证它总是有`access_token`, `refresh_token`和`user`\n\n```\ninterface Session {\n    provider_token?: string | null\n    access_token: string\n    expires_in?: number\n    expires_at?: number\n    refresh_token: string\n    token_type: string\n    user: User\n}\n```\n\n### 新的认证方法 [*link*](#%e6%96%b0%e7%9a%84%e8%ae%a4%e8%af%81%e6%96%b9%e6%b3%95)\n\n我们将删除`signIn()`方法，改用更明确的函数签名。\n`signInWithPassword()`, `signInWithOtp()`, 和 `signInWithOtp()`.\n\n```\n// v2\nconst { data } = await supabase.auth.signInWithPassword({\n  email: 'hello@example',\n  password: 'pass',\n})\n// v1\nconst { data } = await supabase.auth.signIn({\n  email: 'hello@example',\n  password: 'pass',\n})\n```\n\n### 新的实时方法 [*link*](#%e6%96%b0%e7%9a%84%e5%ae%9e%e6%97%b6%e6%96%b9%e6%b3%95)\n\n在Realtime库中有一个新的`channel()`方法，它将被用于我们的多人游戏更新。\n\n```\nsupabase\n  .channel('any_string_you_want')\n  .on('presence', { event: 'track' }, (payload) => {\n    console.log(payload)\n  })\n  .subscribe()\n\nsupabase\n  .channel('any_string_you_want')\n  .on(\n    'postgres_changes',\n    {\n      event: 'INSERT',\n      schema: 'public',\n      table: 'movies',\n    },\n    (payload) => {\n      console.log(payload)\n    }\n  )\n  .subscribe()\n```\n\n我们将废弃以前用于监听postgres变化的`.from().on().subscribe()‘方法。\n\n### 废弃的setAuth() [*link*](#%e5%ba%9f%e5%bc%83%e7%9a%84setauth)\n\n废弃并删除了`setAuth()`。要设置一个自定义的`access_token` jwt，请将自定义的头信息传入提供的`createClient()`方法：([PR](https://github.com/supabase/gotrue-js/pull/340))\n\n### 所有变化 [*link*](#%e6%89%80%e6%9c%89%e5%8f%98%e5%8c%96)\n\n* `supabase-js`\n  + `shouldThrowOnError`已被删除，直到所有客户端库都支持该选项（[PR](https://github.com/supabase/supabase-js/pull/490)）。\n* `postgrest-js`\n  + TypeScript的类型已被重新设计 [PR](https://github.com/supabase/postgrest-js/pull/279)\n  + 对函数参数、类型等使用`undefined`而不是`null`(<https://github.com/supabase/postgrest-js/pull/278>)\n  + 一些功能现在已经过时了：(<https://github.com/supabase/postgrest-js/pull/275>)\n    - 过滤器缩写（例如：`cs`与`contains`）。\n    - 响应中的 “body”（相对于 “data”）。\n    - 通过”.insert() “方法进行 “上载”。\n    - `PostgrestClient`上的`auth`方法\n    - 客户端级别的`throwOnError’方法\n* `Gotrue-js`\n  + `supase-js`客户端允许传递一个`storageKey`参数，这将允许用户设置本地存储中用于存储会话的密钥。默认情况下，这将与supabase项目参考文献一起被命名为空间。([PR](https://github.com/supabase/supabase-js/pull/460))\n  + `signIn`方法现在分为`signInWithPassword`, `signInWithOtp`, `signInWithOAuth` ([PR](https://github.com/supabase/gotrue-js/pull/304))\n  + 弃用并删除了`session()`, `user()`，改用`getSession()`。如果用户已经登录，`getSession()`将总是返回一个有效的会话，这意味着不再有随机注销。([PR](https://github.com/supabase/gotrue-js/pull/299))\n  + 废弃并删除了对`multitab'支持的设置，因为`getSession()`和gotrue的重用间隔设置已经处理了多个标签的会话管理([PR](https://github.com/supabase/gotrue-js/pull/366))\n  + 不再抛出随机错误，gotrue-js v2总是返回一个自定义的错误类型：([PR](https://github.com/supabase/gotrue-js/pull/341))\n    - `AuthSessionMissingError`(AuthSession错误)\n      * 表示预期有一个会话，但没有。\n    - `AuthNoCookieError`表示预期有cookie，但没有。\n      * 表示期望有一个cookie，但没有。\n    - `AuthInvalidCredentialsError`表示期望有一个cookie但没有。\n      * 表示传递了不正确的凭证。\n  + 将 “api “命名空间更名为 “admin”，“admin “命名空间将只包含只能在受信任的服务器端环境中使用的方法，并配有服务角色密钥\n  + 将`resetPasswordForEmail`、`getUser`和`updateUser`移至`GoTrueClient`，这意味着它们可以从`supabase.auth`命名空间访问`supabase-js`，而不是通过`supabase.auth.api`来访问它们。\n  + 删除了`sendMobileOTP`, `sendMagicLinkEmail`，改用`signInWithOtp`。\n  + 删除了`signInWithEmail`, `signInWithPhone`，改为`signInWithPassword`。\n  + 删除了 “用电子邮件签名”、“用电话签名”，改为 “签名”。\n  + 用 “updateUser “代替了 “update”。\n* `Storage-js`。\n  + 返回类型更加严格。函数类型曾经表明，即使没有错误，返回的数据也可能是空的。现在我们使用联合类型，只有在出现错误时才将数据标记为空，反之亦然。([PR](https://github.com/supabase/storage-js/pull/60))\n  + `upload`和`update`函数返回上传对象的路径作为`path`参数。以前的返回值是将桶的名称预置在路径上，这使得该值难以传递给其他storage-js方法，因为所有的方法都是单独获取桶的名称和路径。我们还选择将返回值称为`path`而不是`Key`([PR](https://github.com/supabase/storage-js/pull/75))\n  + `getPublicURL`只返回数据对象中的公共URL。这与我们的其他方法保持一致，只在数据对象内返回。没有错误返回，因为这个方法不能抛出一个错误([PR](https://github.com/supabase/storage-js/pull/93))\n  + 在`createSignedUrl'和`createSignedUrls’中，签名的URL将以`signedUrl'而不是`signedURL’返回([PR](https://github.com/supabase/storage-js/pull/94))\n  + 对`createSignedUrl`、`createSignedUrls`和`getPublicUrl`返回的URL进行编码([PR](https://github.com/supabase/storage-js/pull/86))\n  + `createsignedUrl`曾经直接返回一个URL，并在数据对象中。这是不一致的。现在我们在所有方法中都只返回数据对象中的值。([PR](https://www.notion.so/LW5-supabase-js-v2-7b0bfcdf571d4f20b9b7a9308883f24b))\n  + `createBucket`返回一个数据对象，而不是直接返回桶的名字。([PR](https://github.com/supabase/storage-js/pull/89))\n  + 固定了元数据的类型 ([PR](https://github.com/supabase/storage-js/pull/90))\n  + 更好的错误类型使其更容易快速追踪到出错的原因。\n  + `SupabaseStorageClient`不再被导出。使用 “StorageClient “代替。([PR](https://github.com/supabase/storage-js/pull/92))。\n* `Realtime-js`。\n  + `RealtimeSubscription`类不再存在，被`RealtimeChannel`取代。\n  + `RealtimeClient`的`disconnect`方法现在返回类型为`void`。以前它返回的类型是`Promise<{ error: Error | null; data: boolean }`。\n  + 从`SupabaseClient`类中删除了`removeAllSubscriptions`和`removeSubscription`方法。\n  + 删除了 “SupabaseRealtimeClient “类。\n  + 删除了 “SupabaseQueryBuilder “类。\n  + 删除了 “SupabaseEventTypes “类型。\n    - 考虑将其重命名为 “RealtimePostgresChangeEvents”，并将其移至 “realtime-js “版本。\n  + 删除了`.from('table').on('INSERT', () ⇒ {}).subscribe()`，以支持新的实时客户端API。\n\n---\n\n[*navigate\\_before* 支持Typescript](/docs/app/sdkdocs/javascript/start/typescript-support/)\n\n[Select 查询 *navigate\\_next*](/docs/app/sdkdocs/javascript/database/select/)"
}