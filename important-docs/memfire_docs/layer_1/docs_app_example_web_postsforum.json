{
  "url": "https://docs.memfiredb.com/docs/app/example/web/postsforum/",
  "title": "Posts社交网络论坛 | MemFire Cloud在线文档",
  "depth": 1,
  "timestamp": "2025-08-12 17:53:41",
  "html": "<main class=\"page-content bg-transparent\">\n<div class=\"top-header d-print-none\" id=\"top-header\">\n<div class=\"header-bar d-flex justify-content-between\">\n<div class=\"d-flex align-items-center\">\n<a alt=\"HomePage\" aria-label=\"HomePage\" class=\"logo-icon me-3\" href=\"/\">\n<div class=\"small\">\n<!--?xml version=\"1.0\" encoding=\"UTF-8\"?-->\n<svg height=\"112px\" version=\"1.1\" viewbox=\"0 0 99 112\" width=\"99px\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<title>MemFireDB备份 6</title>\n<defs>\n<lineargradient id=\"linearGradient-1\" x1=\"49.9999885%\" x2=\"49.9999885%\" y1=\"98.082503%\" y2=\"0.766550128%\">\n<stop offset=\"0%\" stop-color=\"#ED1C23\"></stop>\n<stop offset=\"100%\" stop-color=\"#FBAF3B\"></stop>\n</lineargradient>\n</defs>\n<g fill=\"none\" fill-rule=\"evenodd\" id=\"定稿\" stroke=\"none\" stroke-width=\"1\">\n<g id=\"MemFireDB备份-6\">\n<polygon fill=\"#F9AE7C\" id=\"Fill-1\" points=\"25.9728553 40.7912363 47.4268317 0.00591833831 1.15453123 26.7215251\"></polygon>\n<polygon fill=\"#F9AE7C\" id=\"Fill-3\" points=\"97.4213117 26.7267606 51.1285247 0.000910513587 72.4242993 40.8351686\"></polygon>\n<polygon fill=\"#F9904A\" id=\"Fill-5\" points=\"24.8347133 42.7618153 0.000455256793 28.682999 0.000455256793 82.1608764\"></polygon>\n<polygon fill=\"url(#linearGradient-1)\" id=\"Fill-7\" points=\"27.6634514 42.4662399 49.279044 109.05096 70.7296059 42.507213 49.2779058 1.3747617\"></polygon>\n<polygon fill=\"#F9904A\" id=\"Fill-9\" points=\"98.5660549 28.6951771 73.5622137 42.8047233 98.5660549 82.1719163\"></polygon>\n<polygon fill=\"#FB6D33\" id=\"Fill-13\" points=\"72.2987623 45.061545 50.7514582 111.900071 97.579172 84.8646465\"></polygon>\n<polygon fill=\"#FB6D33\" id=\"Fill-15\" points=\"26.1006687 45.0226206 0.987565799 84.8644188 47.8095888 111.898705\"></polygon>\n<path d=\"M60.0737516,38.507213 C59.3168872,35.669825 57.0462939,33.3514298 57.0462939,33.3514298 C57.0462939,33.3514298 57.0804382,35.8849338 56.2894295,37.513615 C55.4847631,39.1696116 53.8765685,40.3054773 53.8765685,40.3054773 C53.8765685,40.3054773 56.1016361,33.8840802 54.2715038,30.1247973 C52.0259496,25.5073552 49.1771803,23.3357803 49.1771803,23.3357803 C49.1771803,23.3357803 50.1070423,28.1319107 48.6240432,31.5065016 C47.1672215,34.8264618 42.8058614,36.7260208 40.7241997,38.7132167 C39.1865699,40.1791435 38.0814341,43.0711623 37.6068289,44.4847347 C37.5715465,44.5883056 37.560165,44.6918765 37.5533362,44.7943093 C37.584066,43.9816759 37.8890881,39.8024186 40.9654858,37.4293925 C43.8404325,35.2111538 41.2431925,30.3478731 41.2431925,30.3478731 C41.2431925,30.3478731 41.7212121,32.5638355 40.9939394,34.1401622 C40.2655285,35.7153507 38.7187936,36.5962726 38.0154218,38.259098 C37.3883056,39.7409589 37.5203301,44.1432921 37.5453692,44.8409731 C37.5453692,44.8591834 37.5476455,44.8762555 37.5476455,44.8921895 C37.5476455,44.9263338 37.5487836,44.9456822 37.5487836,44.9456822 L37.5487836,44.9115379 C37.5590269,45.2655001 37.7138142,45.6080808 37.9972116,45.8448143 L48.3713757,55.6442168 C48.8380139,56.0323232 49.5163466,56.0334614 49.9841229,55.6476312 L60.5938825,45.7105136 C60.9034571,45.4544316 61.0719021,45.0686015 61.0457249,44.6656992 C60.9546735,43.2282259 60.5699815,40.3692133 60.0737516,38.507213\" fill=\"#FFFFFF\" id=\"Fill-17\"></path>\n</g>\n</g>\n</svg>\n</div>\n<div class=\"big\">\n<svg height=\"20\" width=\"232\" xmlns=\"http://www.w3.org/2000/svg\"><defs><lineargradient id=\"a\" x1=\"50%\" x2=\"50%\" y1=\"98.083%\" y2=\".767%\"><stop offset=\"0%\" stop-color=\"#ED1C23\"></stop><stop offset=\"100%\" stop-color=\"#FBAF3B\"></stop></lineargradient></defs><g fill=\"none\" fill-rule=\"evenodd\"><path d=\"M78.622 12.384l1.596 21.94H77.49l-.847-14.154-8.98 15.523-4.899-15.53-4.416 14.162H55.6l7.085-21.871 5.712 17.174 10.224-17.244zm99.46.382l.324.01.454.036c.085.008.175.018.269.03l.61.096c1.09.203 2.518.644 3.883 1.596l.515.383-.46 3.694-.413-.62-.154-.195-.255-.285c-.765-.802-2.485-2.188-5.23-2.188-4.55 0-8.723 3.809-9.3 8.491-.287 2.311.334 4.469 1.755 6.077 1.342 1.517 3.257 2.354 5.39 2.354 2.606 0 4.58-1.225 5.606-2.04l.359-.3.424-.408.507-.552-.466 3.766-.093.06a12.622 12.622 0 01-4.577 1.842l-.629.1-.53.058-.418.027-.444.003c-2.918-.002-5.532-1.142-7.36-3.21-1.851-2.096-2.67-4.88-2.305-7.837.73-5.88 5.964-10.696 11.806-10.974l.732-.014zm18.174 9.018c1.724 0 3.344.713 4.443 1.956 1.101 1.248 1.59 2.88 1.377 4.596-.432 3.504-3.808 6.466-7.375 6.466-1.728 0-3.348-.715-4.45-1.96-1.096-1.242-1.583-2.864-1.377-4.563.44-3.52 3.818-6.495 7.382-6.495zm19.446.535l-1.486 12.02h-2.558l.16-1.292c-.936.93-2.462 1.755-4.173 1.755-1.318 0-2.48-.492-3.267-1.385-.804-.91-1.168-2.184-1.008-3.497l.9-7.274 2.597-.327-.914 7.402c-.101.785.084 1.466.525 1.968.49.552 1.27.845 2.25.845 1.526 0 3.3-1.155 3.51-2.873l.87-7.015 2.594-.327zm-63.587-.547c1.77 0 3.21.58 4.164 1.678 1.047 1.207 1.48 3.01 1.263 5.233l-.097.771h-9.914c.16 1.896 1.567 2.979 3.895 2.979 1.806 0 2.878-.434 3.868-.961l1.119-.623-.312 2.522-.106.06c-1.224.687-2.604 1.356-4.8 1.356-2.092 0-3.873-.708-5.006-1.992-.991-1.12-1.404-2.599-1.198-4.272.548-4.433 4.001-6.751 7.124-6.751zm-62.717 0c1.771 0 3.211.58 4.164 1.678 1.048 1.207 1.48 3.01 1.263 5.233l-.097.771h-9.914c.16 1.896 1.567 2.979 3.895 2.979 1.622 0 2.652-.35 3.563-.803l.594-.315.83-.466-.312 2.522-.105.06c-1.224.687-2.604 1.356-4.8 1.356-2.093 0-3.874-.708-5.007-1.992-.99-1.12-1.404-2.599-1.197-4.272.547-4.433 4-6.751 7.123-6.751zM231.476 12l-2.767 22.34h-2.556l.197-1.59c-1.104 1.191-2.882 2.021-4.471 2.021-1.781 0-3.24-.583-4.217-1.69-1.02-1.151-1.452-2.817-1.222-4.686.485-3.908 3.43-6.636 7.167-6.636 1.565 0 3.065.832 3.852 2.064l1.356-10.968 2.661-.855zm-42.07.002L186.64 34.34h-2.556l2.664-21.483 2.66-.854zm-56.632 1.268l-1.166 2.527h-9.586l-.85 6.867h6.627v.48h-.12l-.883 1.778v.24h-5.933l-1.138 9.163h-2.729l2.612-21.055h13.166zm2.715 9.038l-1.497 12.017h-2.559l1.455-11.722 2.601-.295zm-24.427-.537c1 0 1.93.427 2.616 1.204.84.95 1.224 2.29 1.053 3.677l-.955 7.673h-2.527l.922-7.445c.13-1.017-.027-1.81-.45-2.287-.326-.367-.815-.554-1.458-.554-1.954 0-3.178 1.346-3.332 2.613l-.955 7.673h-2.556l.922-7.445c.127-1.03-.024-1.826-.442-2.297-.319-.362-.801-.544-1.437-.544-1.522 0-3.3 1.166-3.516 2.901l-.912 7.385h-2.559l1.455-11.722 2.594-.295-.146 1.164c1.027-1.077 2.419-1.701 3.854-1.701 1.375 0 2.58.79 3.226 2.083.914-1.13 2.05-2.083 4.603-2.083zm29.487.532l-.206 1.73c1.082-.978 2.932-1.7 4.514-1.7h.269l-.271 2.282h-.214c-1.814 0-4.469.837-4.7 2.7l-.866 7.01h-2.558l1.45-11.693 2.582-.329zm55.47 1.865c-2.31 0-4.27 1.792-4.563 4.168-.144 1.145.15 2.196.824 2.957.64.725 1.586 1.126 2.656 1.126 2.292 0 4.241-1.78 4.532-4.14.146-1.169-.144-2.237-.821-3.003-.634-.715-1.567-1.108-2.628-1.108zm27.497-.029c-2.278 0-4.15 1.752-4.45 4.17-.149 1.187.137 2.255.8 3.006.611.692 1.526 1.076 2.57 1.076 2.294 0 4.173-1.743 4.468-4.143.152-1.21-.13-2.285-.79-3.033-.623-.704-1.52-1.076-2.598-1.076zm-134.356.045c-1.89 0-3.372 1.094-4.015 2.947h7.164a2.853 2.853 0 00-.71-1.956c-.574-.648-1.416-.991-2.439-.991zm62.715 0c-1.892 0-3.37 1.094-4.013 2.947h7.166a2.867 2.867 0 00-.713-1.956c-.573-.648-1.416-.991-2.44-.991zm-17.267-7.614c.919 0 1.706.748 1.754 1.668a1.587 1.587 0 01-1.603 1.692c-.917 0-1.704-.75-1.754-1.668a1.593 1.593 0 011.603-1.692z\" fill=\"#116\"></path><path d=\"M11.131 17.482L20.326.002.495 11.453zm30.621-6.028L21.912 0l9.127 17.5z\" fill=\"#F9AE7C\"></path><path d=\"M10.643 18.326L0 12.293v22.919z\" fill=\"#F9904A\"></path><path d=\"M11.856 18.2l9.264 28.536 9.193-28.519L21.119.59z\" fill=\"url(#a)\"></path><path d=\"M42.243 12.298l-10.716 6.047 10.716 16.872z\" fill=\"#F9904A\"></path><path d=\"M30.985 19.312l-9.234 28.645L41.82 36.371zm-19.799-.017L.423 36.37 20.49 47.957z\" fill=\"#FB6D33\"></path><path d=\"M25.746 16.503c-.324-1.216-1.298-2.21-1.298-2.21s.015 1.086-.324 1.784c-.345.71-1.034 1.197-1.034 1.197s.954-2.752.17-4.363c-.963-1.98-2.184-2.91-2.184-2.91s.398 2.056-.237 3.502c-.624 1.423-2.494 2.237-3.386 3.088-.659.629-1.132 1.868-1.336 2.474a.509.509 0 00-.023.133c.013-.349.144-2.14 1.463-3.157 1.232-.95.119-3.035.119-3.035s.205.95-.107 1.625c-.312.676-.975 1.053-1.277 1.766-.268.635-.212 2.522-.201 2.82v.023l.001.022v-.014a.54.54 0 00.193.4l4.446 4.2c.2.166.49.166.69.001l4.548-4.259a.535.535 0 00.193-.448c-.039-.616-.203-1.84-.416-2.639\" fill=\"#FFF\"></path></g></svg>\n</div>\n</a>\n<button class=\"btn btn-icon btn-soft\" id=\"close-sidebar\">\n<span class=\"material-icons size-20 menu-icon align-middle\">menu</span>\n</button>\n</div>\n<div class=\"d-flex align-items-center\">\n<ul class=\"list-unstyled mb-0\">\n</ul>\n<a class=\"btn btn-icon btn-default ms-4\" href=\"https://memfiredb.com/\" target=\"_blank\" type=\"button\">官网</a>\n<a class=\"btn btn-icon btn-default ms-4\" href=\"https://community.memfiredb.com/\" target=\"_blank\" type=\"button\">论坛</a>\n<a class=\"btn btn-icon btn-default ms-4\" href=\"https://cloud.memfiredb.com/auth/login\" target=\"_blank\" type=\"button\">登录</a>\n<button aria-label=\"Toggle user interface mode\" class=\"btn btn-icon btn-default ms-2\" id=\"mode\" type=\"button\">\n<span class=\"toggle-dark\">\n<svg fill=\"currentColor\" height=\"30\" viewbox=\"0 0 48 48\" width=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>Enable dark mode</title>\n<path d=\"M24 42q-7.5 0-12.75-5.25T6 24q0-7.5 5.25-12.75T24 6q.4 0 .85.025.45.025 1.15.075-1.8 1.6-2.8 3.95-1 2.35-1 4.95 0 4.5 3.15 7.65Q28.5 25.8 33 25.8q2.6 0 4.95-.925T41.9 22.3q.05.6.075.975Q42 23.65 42 24q0 7.5-5.25 12.75T24 42Zm0-3q5.45 0 9.5-3.375t5.05-7.925q-1.25.55-2.675.825Q34.45 28.8 33 28.8q-5.75 0-9.775-4.025T19.2 15q0-1.2.25-2.575.25-1.375.9-3.125-4.9 1.35-8.125 5.475Q9 18.9 9 24q0 6.25 4.375 10.625T24 39Zm-.2-14.85Z\"></path>\n</svg>\n</span>\n<span class=\"toggle-light\">\n<svg fill=\"currentColor\" height=\"30\" viewbox=\"0 0 48 48\" width=\"30\" xmlns=\"http://www.w3.org/2000/svg\">\n<title>Enable light mode</title>\n<path d=\"M24 31q2.9 0 4.95-2.05Q31 26.9 31 24q0-2.9-2.05-4.95Q26.9 17 24 17q-2.9 0-4.95 2.05Q17 21.1 17 24q0 2.9 2.05 4.95Q21.1 31 24 31Zm0 3q-4.15 0-7.075-2.925T14 24q0-4.15 2.925-7.075T24 14q4.15 0 7.075 2.925T34 24q0 4.15-2.925 7.075T24 34ZM3.5 25.5q-.65 0-1.075-.425Q2 24.65 2 24q0-.65.425-1.075Q2.85 22.5 3.5 22.5h5q.65 0 1.075.425Q10 23.35 10 24q0 .65-.425 1.075-.425.425-1.075.425Zm36 0q-.65 0-1.075-.425Q38 24.65 38 24q0-.65.425-1.075.425-.425 1.075-.425h5q.65 0 1.075.425Q46 23.35 46 24q0 .65-.425 1.075-.425.425-1.075.425ZM24 10q-.65 0-1.075-.425Q22.5 9.15 22.5 8.5v-5q0-.65.425-1.075Q23.35 2 24 2q.65 0 1.075.425.425.425.425 1.075v5q0 .65-.425 1.075Q24.65 10 24 10Zm0 36q-.65 0-1.075-.425-.425-.425-.425-1.075v-5q0-.65.425-1.075Q23.35 38 24 38q.65 0 1.075.425.425.425.425 1.075v5q0 .65-.425 1.075Q24.65 46 24 46ZM12 14.1l-2.85-2.8q-.45-.45-.425-1.075.025-.625.425-1.075.45-.45 1.075-.45t1.075.45L14.1 12q.4.45.4 1.05 0 .6-.4 1-.4.45-1.025.45-.625 0-1.075-.4Zm24.7 24.75L33.9 36q-.4-.45-.4-1.075t.45-1.025q.4-.45 1-.45t1.05.45l2.85 2.8q.45.45.425 1.075-.025.625-.425 1.075-.45.45-1.075.45t-1.075-.45ZM33.9 14.1q-.45-.45-.45-1.05 0-.6.45-1.05l2.8-2.85q.45-.45 1.075-.425.625.025 1.075.425.45.45.45 1.075t-.45 1.075L36 14.1q-.4.4-1.025.4-.625 0-1.075-.4ZM9.15 38.85q-.45-.45-.45-1.075t.45-1.075L12 33.9q.45-.45 1.05-.45.6 0 1.05.45.45.45.45 1.05 0 .6-.45 1.05l-2.8 2.85q-.45.45-1.075.425-.625-.025-1.075-.425ZM24 24Z\"></path>\n</svg>\n</span>\n</button>\n</div>\n</div>\n</div>\n<div class=\"container-fluid\">\n<div class=\"layout-spacing\">\n<div class=\"d-md-flex justify-content-between align-items-center\"></div>\n<div class=\"row flex-xl-nowrap\">\n<div class=\"docs-toc col-xl-3 d-xl-block\"><toc>\n<div class=\"fw-bold text-uppercase mb-2\">本页</div>\n\n</toc></div>\n<div class=\"docs-toc-mobile d-print-none d-xl-none\">\n<button aria-expanded=\"false\" class=\"btn-secondary dropdown-toggle\" data-bs-offset=\"0,0\" data-bs-toggle=\"dropdown\" id=\"toc-dropdown-btn\" type=\"button\">\n                                                Table of Contents\n                                            </button>\n</div>\n<div class=\"docs-content col-12 col-xl-9 mt-0\">\n<div class=\"mb-0 d-flex\">\n<h1 class=\"content-title mb-0\">\n                                                    Posts社交网络论坛\n                                                    \n                                                </h1>\n</div>\n<div class=\"main-content\" data-bs-root-margin=\"0px 0px -65%\" data-bs-spy=\"scroll\" data-bs-target=\"#toc-mobile\" id=\"content\">\n<div data-prismjs-copy=\"\" data-prismjs-copy-error=\"\" data-prismjs-copy-success=\"\">\n<p>MemFire Cloud是一款提供云数据库，用户可以创建云数据库，并对数据库进行管理，还可以对数据库进行备份操作。它还提供后端即服务，用户可以在1分钟内新建一个应用，使用自动生成的API和SDK，访问云数据库、对象存储、用户认证与授权等功能，可专注于编写前端应用程序代码，加速WEB或APP应用开发。</p>\n<p>本篇文章将会教大家手把手使用MemFire Cloud做一个Posts社交网络论坛应用。我们基于Posts社交网络论坛应用做了一个详细的教程，来讲一讲在通过MemFire Cloud开发Posts社交网络论坛应用的开发步骤及注意事项，希望能真正解决用户使用MemFire Cloud过程中遇到的问题和提供一些应用实现的小技巧。</p>\n<h3 id=\"开发前需要知道的一些事\">开发前需要知道的一些事 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e5%bc%80%e5%8f%91%e5%89%8d%e9%9c%80%e8%a6%81%e7%9f%a5%e9%81%93%e7%9a%84%e4%b8%80%e4%ba%9b%e4%ba%8b\"><i class=\"material-icons align-middle\">link</i></a></h3><p><strong>应用介绍</strong></p>\n<p>一个开放的社交网络论坛，任何人都可以在这里分享他们的想法和意见。</p>\n<p><strong>应用基础</strong></p>\n<p>Posts社交网络论坛是基于supabase官网的一个todo-list应用示例为基础，在这个基础上进行修改，删除，增加一些代码逻辑及功能的应用。</p>\n<p><strong>开发条件</strong></p>\n<p>您需要对vue3及ts有一定的了解；</p>\n<p>您需要对sql语法有一定的了解；</p>\n<p><strong>开发依赖</strong></p>\n<p>“@supabase/supabase-js”: “^1.1.2”</p>\n<p>“vue”: “^3.0.0”</p>\n<p>“node.js”:“14.19.0”</p>\n<p>“npm”:“6.14.16”</p>\n<h3 id=\"1准备工作\">1.准备工作 <a aria-hidden=\"true\" class=\"anchor\" href=\"#1%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c\"><i class=\"material-icons align-middle\">link</i></a></h3><p>创建应用</p>\n<p>登录https://cloud.memfiredb.com 创建应用，打开应用后，查看并获取服务地址以及token信息</p>\n<p>创建应用的一步很关键，我们的posts应用就是通过在这里创建的应用来获得数据库、对象存储等一系列资源，并将获得该应用专属的API访问链接和访问密钥，用户可以轻松的与以上资源进行交互。想知道关于应用更详细的内容请查看<a href=\"https://docs.memfiredb.com/base/application-introduction.html\" rel=\"external\" target=\"_blank\">查看文档<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a></p>\n<img src=\"../../../img/样例-discuss-3.png\"/>\n<p>进入应用，我们在这里可以看到，Anon public是客户端API密钥。它允许“匿名访问”您的数据库，直到用户登录。登录后，密钥将切换到用户自己的登录令牌。这将为数据启用行级安全性。</p>\n<p>注意：service_role secret可以绕过任何安全策略完全访问您的数据。这些密钥必须保密，并且要在服务器环境中使用，决不能在客户端或浏览器上使用。</p>\n<p>在后续示例代码中，需要提供supabaseUrl和supabaseKey。</p>\n<p>supabaseUrl就是上图的网址链接，supabaseKey就是Anon API密钥</p>\n<p>想知道关于应用的连接更详细的内容请<a href=\"https://docs.memfiredb.com/base/api.html#api-url%E5%92%8C%E5%AF%86%E9%92%A5\" rel=\"external\" target=\"_blank\">查看文档<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a></p>\n<p>下载代码</p>\n<p>todo-list模板代码（需要下载,选择项目为supabase /examples/vue3-ts-todo-list）：</p>\n<p>git clone <a href=\"https://gitee.com/memfiredb/supabase\" rel=\"external\" target=\"_blank\">https://gitee.com/memfiredb/supabase<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a></p>\n<p>Posts最终代码</p>\n<p>git clone <a href=\"https://github.com/LucaRao/memfire-post.git\" rel=\"external\" target=\"_blank\">https://github.com/LucaRao/memfire-post.git<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a></p>\n<h3 id=\"2修改项目名称\">2.修改项目名称 <a aria-hidden=\"true\" class=\"anchor\" href=\"#2%e4%bf%ae%e6%94%b9%e9%a1%b9%e7%9b%ae%e5%90%8d%e7%a7%b0\"><i class=\"material-icons align-middle\">link</i></a></h3><p>将项目名vue3-ts-todo-list改为Posts</p>\n<h3 id=\"3配置访问密钥\">3.配置访问密钥 <a aria-hidden=\"true\" class=\"anchor\" href=\"#3%e9%85%8d%e7%bd%ae%e8%ae%bf%e9%97%ae%e5%af%86%e9%92%a5\"><i class=\"material-icons align-middle\">link</i></a></h3><p>每个Supabase项目都有一个独特的API URL。您的 API 在一个 API 网关的保护下，每次请求都需要一个 API 密钥。</p>\n<p>将上一步中获取的anon public和网址分别设置到supabaseUrl和supabaseKey中</p>\n<p>（1）将根目录下的.env.local.example改为.env.local</p>\n<p>（2）supabaseUrl和supabaseKey分别赋值给VUE_APP_SUPABASE_URL和VUE_APP_SUPABASE_KEY</p>\n<h3 id=\"4表结构初始化\">4.表结构初始化 <a aria-hidden=\"true\" class=\"anchor\" href=\"#4%e8%a1%a8%e7%bb%93%e6%9e%84%e5%88%9d%e5%a7%8b%e5%8c%96\"><i class=\"material-icons align-middle\">link</i></a></h3><p>接下来我们需要创建数据表，posts表是用来存储用户论坛评论的数据，likes表用来存储用户点赞的某条评论的数据。</p>\n<img src=\"../../../img/样例-posts-2.png\"/>\n<img src=\"../../../img/样例-posts-3.png\"/>\n<p>数据表结构：</p>\n<p>posts（论坛评论列表）\n\n\n\n\n\n\n\n</p><table class=\"table table-striped-columns\">\n<thead>\n<tr>\n<th>名称</th>\n<th>类型</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>id</td>\n<td>in8</td>\n<td>主键，自增，每条评论的唯一标识ID</td>\n</tr>\n<tr>\n<td>task</td>\n<td>text</td>\n<td>评论</td>\n</tr>\n<tr>\n<td>email</td>\n<td>text</td>\n<td>用户名</td>\n</tr>\n<tr>\n<td>created_at</td>\n<td>timestamptz</td>\n<td>日期，可为空</td>\n</tr>\n</tbody>\n</table>\n\nlikes（点赞表）\n\n\n\n\n\n\n\n<table class=\"table table-striped-columns\">\n<thead>\n<tr>\n<th>名称</th>\n<th>类型</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>id</td>\n<td>int8</td>\n<td>主键，自增，每条评论的唯一标识ID</td>\n</tr>\n<tr>\n<td>email_name</td>\n<td>text</td>\n<td>用户名</td>\n</tr>\n<tr>\n<td>post_id</td>\n<td>int8</td>\n<td>每条评论的唯一id</td>\n</tr>\n<tr>\n<td>created_at</td>\n<td>timestamptz</td>\n<td>日期，可为空</td>\n</tr>\n</tbody>\n</table>\n\nsql初始化语句<p></p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-sql\" id=\"08e2755\" tabindex=\"0\"><code class=\"language-sql\"><span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">EXISTS</span> <span class=\"token keyword\">public</span><span class=\"token punctuation\">.</span>posts<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">drop</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">EXISTS</span> <span class=\"token keyword\">public</span><span class=\"token punctuation\">.</span>likes<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">public</span><span class=\"token punctuation\">.</span>posts <span class=\"token punctuation\">(</span>\n  id <span class=\"token keyword\">bigint</span> generated <span class=\"token keyword\">by</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">identity</span> <span class=\"token keyword\">primary</span> <span class=\"token keyword\">key</span><span class=\"token punctuation\">,</span>\n  email <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  task <span class=\"token keyword\">text</span> <span class=\"token keyword\">check</span> <span class=\"token punctuation\">(</span>char_length<span class=\"token punctuation\">(</span>task<span class=\"token punctuation\">)</span> <span class=\"token operator\">&gt;</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  created_at <span class=\"token keyword\">timestamp</span> <span class=\"token keyword\">with</span> <span class=\"token keyword\">time</span> zone <span class=\"token keyword\">default</span> timezone<span class=\"token punctuation\">(</span><span class=\"token string\">'utc'</span>::<span class=\"token keyword\">text</span><span class=\"token punctuation\">,</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">create</span> <span class=\"token keyword\">table</span> <span class=\"token keyword\">public</span><span class=\"token punctuation\">.</span>likes <span class=\"token punctuation\">(</span>\n  id <span class=\"token keyword\">bigint</span> generated <span class=\"token keyword\">by</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">as</span> <span class=\"token keyword\">identity</span> <span class=\"token keyword\">primary</span> <span class=\"token keyword\">key</span><span class=\"token punctuation\">,</span>\n  email_name <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  post_id <span class=\"token keyword\">int</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span> <span class=\"token punctuation\">,</span>\n  created_at <span class=\"token keyword\">timestamp</span> <span class=\"token keyword\">with</span> <span class=\"token keyword\">time</span> zone <span class=\"token keyword\">default</span> timezone<span class=\"token punctuation\">(</span><span class=\"token string\">'utc'</span>::<span class=\"token keyword\">text</span><span class=\"token punctuation\">,</span> <span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">not</span> <span class=\"token boolean\">null</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<h3 id=\"5注册登录功能\">5.注册登录功能 <a aria-hidden=\"true\" class=\"anchor\" href=\"#5%e6%b3%a8%e5%86%8c%e7%99%bb%e5%bd%95%e5%8a%9f%e8%83%bd\"><i class=\"material-icons align-middle\">link</i></a></h3><p>运行项目</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language- language-none\" id=\"b40931b\" tabindex=\"0\"><code class=\"language-none\">npm install\n\nnpm run serve</code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<img src=\"../../../img/样例-posts-4.png\"/>\n<p>注册、登录、退出登录等功能在vue3-todo-list里已经实现，我们不必再次写一遍，也不需要修改文件里面的代码。</p>\n<p>原理</p>\n<p>打开Posts/src/compinents/Auth.vue</p>\n<p>应用的登录、注册、退出登录的逻辑和页面在这里。登录、注册、退出登录都是通过引入的Posts/src/vuetils/useAuth.ts文件里面的相应功能的api来进行交互的，supabase官网提供的todo-list应用的demo已经在useAuth.ts文件里给我们写好了这些功能的接口。</p>\n<p>在Posts/src/vuetils/useAuth.ts文件中看到，在引入supabase依赖之后，我们的登录、注册等功能的api都是由supabase规定熟成的api名称，比如登录叫supabase.auth.signIn，注册叫supabase.auth.signUp。具体<a href=\"https://docs.memfiredb.com/base/javascript/auth-signup.html\" rel=\"external\" target=\"_blank\">查看文档<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a></p>\n<p>我们来创建一个用户并且尝试登录</p>\n<p>控制台显示注册并登录成功，并且已经将我们的用户信息存入了userSession中</p>\n<img src=\"../../../img/样例-posts-5.png\"/>\n<h3 id=\"6实现发布评论功能\">6.实现发布评论功能 <a aria-hidden=\"true\" class=\"anchor\" href=\"#6%e5%ae%9e%e7%8e%b0%e5%8f%91%e5%b8%83%e8%af%84%e8%ae%ba%e5%8a%9f%e8%83%bd\"><i class=\"material-icons align-middle\">link</i></a></h3><p>（1）修改数据类型（ts语法用到数据类型校验）</p>\n<p>打开Posts/src/types/global.ts修改为</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-typescript\" id=\"db1266f\" tabindex=\"0\"><code class=\"language-typescript\"><span class=\"token keyword\">declare</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Credentials</span> <span class=\"token punctuation\">{</span>\n  email<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span>\n  password<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span>\n  provider<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token string\">'bitbucket'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'github'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'gitlab'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'google'</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">declare</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Todo</span> <span class=\"token punctuation\">{</span>\n  id<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n  email<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  task<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n  inserted_at<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n<span class=\"token punctuation\">}</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>（2）编写页面逻辑</p>\n<p>1.打开Posts/src/compinents/TodoList.vue</p>\n<p>2.修改页面样式，用户名这里我们使用邮箱“@”符号之前的字符串。</p>\n<p>修改template页面为</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-html\" id=\"e1ee36f\" tabindex=\"0\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>w-full<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mb-12 font-bold text-3xl<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>Write a new post<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mb-12 font-bold text-2xl<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>welcome { {userSession.user.email.substring(0,userSession.user.email.indexOf('@'))} }!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flex gap-2 my-2<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n        <span class=\"token attr-name\">v-model</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>task<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>rounded w-full p-2<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>What do you need to?<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token punctuation\">/&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>insertTask<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>btn-black<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        Publish\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bg-white shadow overflow-hidden rounded-md<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 300px<span class=\"token punctuation\">;</span><span class=\"token property\">overflow-y</span><span class=\"token punctuation\">:</span> scroll<span class=\"token punctuation\">;</span></span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span> <span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>(todo, index) in allTodos<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>index<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>suspense</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Todo</span> <span class=\"token attr-name\">:todo</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>todo<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>suspense</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">&gt;</span></span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>3.在该页面搜索insertTask方法，这是发布的按钮，将发布论坛评论方法的参数改为email和task</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-javascript\" id=\"47bc3e3\" tabindex=\"0\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> todo <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">email</span><span class=\"token operator\">:</span> userSession<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">task</span><span class=\"token operator\">:</span> task<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>下图就是登录后修改的posts首页</p>\n<img src=\"../../../img/样例-posts-6.png\"/>\n<p>页面引入的Posts/src/vuetils/useTodo.ts文件是用来请求posts列表数据和新增一条post相应功能交互的api的方法</p>\n<p>打开Posts/src/vuetils/useTodo.ts文件</p>\n<p>由于我们修改了表名称，但是逻辑并没有修改，只需要替换查询表名，所以我们将fetchTodos方法里面的查询posts列表语法修改为</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-javascript\" id=\"626dc16\" tabindex=\"0\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> todos<span class=\"token punctuation\">,</span> error <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> supabase<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'posts'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">order</span><span class=\"token punctuation\">(</span><span class=\"token string\">'id'</span><span class=\"token punctuation\">)</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>同上，我们将addTodo里面的新增post语法改为</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-javascript\" id=\"8000c73\" tabindex=\"0\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> error <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> supabase<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'posts'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">insert</span><span class=\"token punctuation\">(</span>todo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">single</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>现在我们在页面插入一条数据，观察控制台的network的接口请求情况，显示插入成功</p>\n<h3 id=\"7渲染评论列表和点赞功能\">7.渲染评论列表和点赞功能 <a aria-hidden=\"true\" class=\"anchor\" href=\"#7%e6%b8%b2%e6%9f%93%e8%af%84%e8%ae%ba%e5%88%97%e8%a1%a8%e5%92%8c%e7%82%b9%e8%b5%9e%e5%8a%9f%e8%83%bd\"><i class=\"material-icons align-middle\">link</i></a></h3><p>打开Posts/src/components/Todo.vue页面，我们要先把页面样式做以下修改</p>\n<p><strong>Template</strong></p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-html\" id=\"f996ab4\" tabindex=\"0\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span>\n    <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>\n      block\n      cursor-pointer\n      hover:bg-gray-200\n      focus:outline-none focus:bg-gray-200\n      transition\n      duration-150\n      ease-in-out\n      border-style1\n    <span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flex items-center px-4 py-4 sm:px-6<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>min-w-0 flex-1 flex items-center<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text-sm leading-5 font-medium truncate t-s<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>{ { todo.task } }<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toggleLike<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>w-4 h-4 ml-2  hover:border-black rounded<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span>\n          <span class=\"token attr-name\">v-if</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>like<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>xlink</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/1999/xlink<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>24px<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>24px<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">preserveAspectRatio</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>xMidYMid meet<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 256 256<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span>\n            <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M236.023 92c0 30.565-17.713 62.005-52.648 93.446a317.34 317.34 0 0 1-51.442 37.534a8 8 0 0 1-7.819 0c-4.25-2.38-104.09-59.117-104.09-130.98a60.02 60.02 0 0 1 108-36.04a60.02 60.02 0 0 1 108 36.04z<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>currentColor<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>path</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>svg</span>\n          <span class=\"token attr-name\">v-else</span>\n          <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2000/svg<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>xlink</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/1999/xlink<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>24px<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>24px<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">preserveAspectRatio</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>xMidYMid meet<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token attr-name\">viewBox</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>0 0 256 256<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token punctuation\">&gt;</span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>path</span>\n            <span class=\"token attr-name\">d</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>M128.018 228a11.995 11.995 0 0 1-5.864-1.53C117.82 224.043 16.018 166.18 16.018 92a64.028 64.028 0 0 1 112-42.378a64.028 64.028 0 0 1 112 42.378c0 74.18-101.803 132.043-106.137 134.47a11.995 11.995 0 0 1-5.863 1.53zm-48-176a40.046 40.046 0 0 0-40 40c0 51.222 67.445 97.186 88 110c20.554-12.814 88-58.778 88-110a40.009 40.009 0 0 0-76.928-15.408a12 12 0 0 1-22.145 0A39.923 39.923 0 0 0 80.018 52z<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">fill</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>currentColor<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token punctuation\">&gt;</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>path</span><span class=\"token punctuation\">&gt;</span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>svg</span><span class=\"token punctuation\">&gt;</span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>flex items-center px-4 py-4 sm:px-6 t-m<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">&gt;</span></span>\n      { {todo.email.substring(0, todo.email.indexOf('@'))} }\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">&gt;</span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">&gt;</span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">&gt;</span></span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p><strong>Css</strong></p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-css\" id=\"9bc72d7\" tabindex=\"0\"><code class=\"language-css\"><span class=\"token selector\">&lt;style lang=\"css\" scoped&gt;\n.border-style1</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> 1px solid #d5d0d0<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 20px 15px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.t-s</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 14px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> bold<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">.t-m</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 13px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> normal<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin-top</span><span class=\"token punctuation\">:</span> -20px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n&lt;/style&gt;</code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>在Todo.vue列表组件中，我们需要展示所有用户的评论、用户名、当前用户是否点赞，列表的数据我们已经在TodoList.vue的fetchTodos方法中拿到，并且传递给了Todo.vue子组件。接下来我们编写点赞接口的逻辑。</p>\n<p>刷新点赞方法：</p>\n<p>原理：likes表里面包含所有当前用户的点赞数据，是通过当前用户的用户名email与遍历当前一条数据的post的id与likes表里面的email_name和post_id是否匹配进行查询，这是一个组件的循环遍历查询，每查一次，看是否查到数据，查到数据则表示该用户给当前的评论点了赞，即为带有当前用户点赞的数据，有的话将当前一条数据的like改为有数据即为true，爱心点亮</p>\n<p>步骤：</p>\n<p>1.在Todo.vue引入文件</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-javascript\" id=\"77caaf4\" tabindex=\"0\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> defineComponent<span class=\"token punctuation\">,</span> ref <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> supabase <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@/lib/supabase'</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> userSession <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@/vuetils/useAuth'</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>2.将Todo.vue逻辑代码都清空，加上下面的刷新点赞的方法</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-javascript\" id=\"cb427ce\" tabindex=\"0\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fecthLike</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> supabase\n      <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'likes'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">post_id</span><span class=\"token operator\">:</span> props<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">email_name</span><span class=\"token operator\">:</span> userSession<span class=\"token operator\">?.</span>value<span class=\"token operator\">?.</span>user<span class=\"token operator\">?.</span>email <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>data<span class=\"token operator\">?.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        like<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          like<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n      <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>切换点赞的方法：</p>\n<p>每次切换完都要刷新一下点赞</p>\n<p>原理：</p>\n<p>点赞就在likes表里添加一条用户用户名email_name和post_id的数据，取消点赞就删除此条数据</p>\n<p>3.增加以下代码</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-javascript\" id=\"2d5b73e\" tabindex=\"0\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">toggleLike</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=&gt;</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>like<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> supabase\n        <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'likes'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">post_id</span><span class=\"token operator\">:</span> props<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">email_name</span><span class=\"token operator\">:</span> userSession<span class=\"token operator\">?.</span>value<span class=\"token operator\">?.</span>user<span class=\"token operator\">?.</span>email <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> supabase\n        <span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token string\">'likes'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">insert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">post_id</span><span class=\"token operator\">:</span> props<span class=\"token punctuation\">.</span>todo<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">email_name</span><span class=\"token operator\">:</span> userSession<span class=\"token operator\">?.</span>value<span class=\"token operator\">?.</span>user<span class=\"token operator\">?.</span>email<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">single</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">fecthLike</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span></code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>Todo.vue完整代码</p>\n<div class=\"prism-codeblock\">\n<div class=\"code-toolbar\"><pre class=\"language-htmlbars\" id=\"a876e4c\" tabindex=\"0\"><code class=\"language-htmlbars\">&lt;template&gt;\n  &lt;li\n    class=\"\n      block\n      cursor-pointer\n      hover:bg-gray-200\n      focus:outline-none focus:bg-gray-200\n      transition\n      duration-150\n      ease-in-out\n      border-style1\n    \"\n  &gt;\n    &lt;div class=\"flex items-center px-4 py-4 sm:px-6\"&gt;\n      &lt;div class=\"min-w-0 flex-1 flex items-center\"&gt;\n        &lt;div class=\"text-sm leading-5 font-medium truncate t-s\"&gt;{{ todo.task }}&lt;/div&gt;\n      &lt;/div&gt;\n      &lt;button @click=\"toggleLike\" class=\"w-4 h-4 ml-2  hover:border-black rounded\"&gt;\n        &lt;svg\n          v-if=\"like\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n          width=\"24px\"\n          height=\"24px\"\n          preserveAspectRatio=\"xMidYMid meet\"\n          viewBox=\"0 0 256 256\"\n        &gt;\n          &lt;path\n            d=\"M236.023 92c0 30.565-17.713 62.005-52.648 93.446a317.34 317.34 0 0 1-51.442 37.534a8 8 0 0 1-7.819 0c-4.25-2.38-104.09-59.117-104.09-130.98a60.02 60.02 0 0 1 108-36.04a60.02 60.02 0 0 1 108 36.04z\"\n            fill=\"currentColor\"\n          &gt;&lt;/path&gt;\n        &lt;/svg&gt;\n        &lt;svg\n          v-else\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n          width=\"24px\"\n          height=\"24px\"\n          preserveAspectRatio=\"xMidYMid meet\"\n          viewBox=\"0 0 256 256\"\n        &gt;\n          &lt;path\n            d=\"M128.018 228a11.995 11.995 0 0 1-5.864-1.53C117.82 224.043 16.018 166.18 16.018 92a64.028 64.028 0 0 1 112-42.378a64.028 64.028 0 0 1 112 42.378c0 74.18-101.803 132.043-106.137 134.47a11.995 11.995 0 0 1-5.863 1.53zm-48-176a40.046 40.046 0 0 0-40 40c0 51.222 67.445 97.186 88 110c20.554-12.814 88-58.778 88-110a40.009 40.009 0 0 0-76.928-15.408a12 12 0 0 1-22.145 0A39.923 39.923 0 0 0 80.018 52z\"\n            fill=\"currentColor\"\n          &gt;&lt;/path&gt;\n        &lt;/svg&gt;\n      &lt;/button&gt;\n    &lt;/div&gt;\n    &lt;div class=\"flex items-center px-4 py-4 sm:px-6 t-m\"&gt;\n      { {todo.email.substring(0, todo.email.indexOf('@'))} }\n    &lt;/div&gt;\n  &lt;/li&gt;\n&lt;/template&gt;\n\n&lt;script lang=\"ts\"&gt;\nimport { defineComponent, PropType, ref } from 'vue'\n/* eslint-disable @typescript-eslint/camelcase */\nimport { supabase } from '@/lib/supabase'\nimport { userSession } from '@/vuetils/useAuth'\n\nexport default defineComponent({\n  name: 'Todo',\n  props: {\n    todo: {\n      type: Object,\n      required: true,\n    },\n  },\n  setup(props) {\n    const like = ref&lt;undefined | null&gt;(undefined)\n    const fecthLike = async () =&gt; {\n      const { data } = await supabase\n        .from('likes')\n        .select('*')\n        .match({\n          post_id: props.todo.id,\n          email_name: userSession?.value?.user?.email || '',\n        })\n        if(data?.length){\n          like.value = data[0]\n        } else {\n            like.value = null\n        }\n  }\n    fecthLike()\n    // Removes todo from supbase and also from app state\n    const toggleLike = async () =&gt; {\n      if (like.value) {\n        await supabase\n          .from('likes')\n          .delete()\n          .match({\n            post_id: props.todo.id,\n            email_name: userSession?.value?.user?.email || '',\n          })\n      } else {\n        await supabase\n          .from('likes')\n          .insert({\n            post_id: props.todo.id,\n            email_name: userSession?.value?.user?.email,\n          })\n          .single()\n      }\n    fecthLike()\n    }\n\n    return { toggleLike, userSession,like,fecthLike }\n  },\n\n})\n&lt;/script&gt;\n\n&lt;style lang=\"css\" scoped&gt;\n.border-style1 {\n  border: 1px solid #d5d0d0;\n  margin: 20px 15px;\n  border-radius: 10px;\n}\n.t-s {\n  font-size: 14px;\n  font-weight: bold;\n}\n.t-m {\n  font-size: 13px;\n  font-weight: normal;\n  margin-top: -20px;\n}\n&lt;/style&gt;</code></pre><div class=\"toolbar\"><div class=\"toolbar-item\"><button aria-label=\"copy\" class=\"copy-to-clipboard-button\" data-copy-state=\"copy\" type=\"button\"><span></span></button></div></div></div>\n</div>\n<p>小技巧：</p>\n<p>具体的增删改查的语法可以参考<a href=\"https://docs.memfiredb.com/base/javascript/select.html\" rel=\"external\" target=\"_blank\">文档<svg height=\"16\" viewbox=\"0 0 24 24\" width=\"16\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 5c-.552 0-1-.448-1-1s.448-1 1-1h6c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1s-1-.448-1-1v-3.586l-7.293 7.293c-.391.39-1.024.39-1.414 0-.391-.391-.391-1.024 0-1.414l7.293-7.293h-3.586zm-9 2c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h11c.552 0 1-.448 1-1v-4.563c0-.552.448-1 1-1s1 .448 1 1v4.563c0 1.657-1.343 3-3 3h-11c-1.657 0-3-1.343-3-3v-11c0-1.657 1.343-3 3-3h4.563c.552 0 1 .448 1 1s-.448 1-1 1h-4.563z\" fill=\"currentColor\"></path></svg></a></p>\n<p>重启一下项目，登录后我们来新增一条数据，新增成功，点赞也成功了！</p>\n<img src=\"../../../img/样例-posts-7.png\"/>\n<p>简单的post应用即完成！</p>\n<h3 id=\"写在结尾的话\">写在结尾的话 <a aria-hidden=\"true\" class=\"anchor\" href=\"#%e5%86%99%e5%9c%a8%e7%bb%93%e5%b0%be%e7%9a%84%e8%af%9d\"><i class=\"material-icons align-middle\">link</i></a></h3><p>以上就是基于一个教程示例对MemFire Cloud的使用和反馈的一些看法，如果在开发中遇到问题，可以参考上面的完整代码项目比对，希望对大家有所帮助。</p>\n</div>\n</div>\n<div><hr class=\"doc-hr\"/>\n<div class=\"d-print-none\" id=\"doc-nav\">\n<div class=\"row flex-xl-nowrap\">\n<div class=\"col-sm-6 pt-2 doc-next\">\n<a href=\"/docs/app/example/wechat/wechatroom/\">\n<div class=\"card h-100 my-1\">\n<div class=\"card-body py-2\">\n<p class=\"card-title fs-5 fw-semibold lh-base mb-0\"><i class=\"material-icons align-middle\">navigate_before</i> 微信小程序聊天室</p>\n</div>\n</div>\n</a>\n</div>\n<div class=\"col-sm-6 pt-2 doc-prev\">\n<a class=\"ms-auto\" href=\"/docs/app/example/web/playground/\">\n<div class=\"card h-100 my-1 text-end\">\n<div class=\"card-body py-2\">\n<p class=\"card-title fs-5 fw-semibold lh-base mb-0\">实时游戏场 <i class=\"material-icons align-middle\">navigate_next</i></p>\n</div>\n</div>\n</a>\n</div>\n</div>\n</div></div>\n</div>\n</div>\n</div>\n</div>\n\n</main>",
  "markdown": "[MemFireDB备份 6](/)\n\nmenu\n\n[官网](https://memfiredb.com/)\n[论坛](https://community.memfiredb.com/)\n[登录](https://cloud.memfiredb.com/auth/login)\n\nEnable dark mode\n\nEnable light mode\n\n本页\n\nTable of Contents\n\n# Posts社交网络论坛\n\nMemFire Cloud是一款提供云数据库，用户可以创建云数据库，并对数据库进行管理，还可以对数据库进行备份操作。它还提供后端即服务，用户可以在1分钟内新建一个应用，使用自动生成的API和SDK，访问云数据库、对象存储、用户认证与授权等功能，可专注于编写前端应用程序代码，加速WEB或APP应用开发。\n\n本篇文章将会教大家手把手使用MemFire Cloud做一个Posts社交网络论坛应用。我们基于Posts社交网络论坛应用做了一个详细的教程，来讲一讲在通过MemFire Cloud开发Posts社交网络论坛应用的开发步骤及注意事项，希望能真正解决用户使用MemFire Cloud过程中遇到的问题和提供一些应用实现的小技巧。\n\n### 开发前需要知道的一些事 [*link*](#%e5%bc%80%e5%8f%91%e5%89%8d%e9%9c%80%e8%a6%81%e7%9f%a5%e9%81%93%e7%9a%84%e4%b8%80%e4%ba%9b%e4%ba%8b)\n\n**应用介绍**\n\n一个开放的社交网络论坛，任何人都可以在这里分享他们的想法和意见。\n\n**应用基础**\n\nPosts社交网络论坛是基于supabase官网的一个todo-list应用示例为基础，在这个基础上进行修改，删除，增加一些代码逻辑及功能的应用。\n\n**开发条件**\n\n您需要对vue3及ts有一定的了解；\n\n您需要对sql语法有一定的了解；\n\n**开发依赖**\n\n“@supabase/supabase-js”: “^1.1.2”\n\n“vue”: “^3.0.0”\n\n“node.js”:“14.19.0”\n\n“npm”:“6.14.16”\n\n### 1.准备工作 [*link*](#1%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c)\n\n创建应用\n\n登录https://cloud.memfiredb.com 创建应用，打开应用后，查看并获取服务地址以及token信息\n\n创建应用的一步很关键，我们的posts应用就是通过在这里创建的应用来获得数据库、对象存储等一系列资源，并将获得该应用专属的API访问链接和访问密钥，用户可以轻松的与以上资源进行交互。想知道关于应用更详细的内容请查看[查看文档](https://docs.memfiredb.com/base/application-introduction.html)\n\n![](../../../img/样例-discuss-3.png)\n\n进入应用，我们在这里可以看到，Anon public是客户端API密钥。它允许“匿名访问”您的数据库，直到用户登录。登录后，密钥将切换到用户自己的登录令牌。这将为数据启用行级安全性。\n\n注意：service\\_role secret可以绕过任何安全策略完全访问您的数据。这些密钥必须保密，并且要在服务器环境中使用，决不能在客户端或浏览器上使用。\n\n在后续示例代码中，需要提供supabaseUrl和supabaseKey。\n\nsupabaseUrl就是上图的网址链接，supabaseKey就是Anon API密钥\n\n想知道关于应用的连接更详细的内容请[查看文档](https://docs.memfiredb.com/base/api.html#api-url%E5%92%8C%E5%AF%86%E9%92%A5)\n\n下载代码\n\ntodo-list模板代码（需要下载,选择项目为supabase /examples/vue3-ts-todo-list）：\n\ngit clone <https://gitee.com/memfiredb/supabase>\n\nPosts最终代码\n\ngit clone <https://github.com/LucaRao/memfire-post.git>\n\n### 2.修改项目名称 [*link*](#2%e4%bf%ae%e6%94%b9%e9%a1%b9%e7%9b%ae%e5%90%8d%e7%a7%b0)\n\n将项目名vue3-ts-todo-list改为Posts\n\n### 3.配置访问密钥 [*link*](#3%e9%85%8d%e7%bd%ae%e8%ae%bf%e9%97%ae%e5%af%86%e9%92%a5)\n\n每个Supabase项目都有一个独特的API URL。您的 API 在一个 API 网关的保护下，每次请求都需要一个 API 密钥。\n\n将上一步中获取的anon public和网址分别设置到supabaseUrl和supabaseKey中\n\n（1）将根目录下的.env.local.example改为.env.local\n\n（2）supabaseUrl和supabaseKey分别赋值给VUE\\_APP\\_SUPABASE\\_URL和VUE\\_APP\\_SUPABASE\\_KEY\n\n### 4.表结构初始化 [*link*](#4%e8%a1%a8%e7%bb%93%e6%9e%84%e5%88%9d%e5%a7%8b%e5%8c%96)\n\n接下来我们需要创建数据表，posts表是用来存储用户论坛评论的数据，likes表用来存储用户点赞的某条评论的数据。\n\n![](../../../img/样例-posts-2.png)\n![](../../../img/样例-posts-3.png)\n\n数据表结构：\n\nposts（论坛评论列表）\n\n| 名称 | 类型 | 描述 |\n| --- | --- | --- |\n| id | in8 | 主键，自增，每条评论的唯一标识ID |\n| task | text | 评论 |\n| email | text | 用户名 |\n| created\\_at | timestamptz | 日期，可为空 |\n\nlikes（点赞表）\n\n| 名称 | 类型 | 描述 |\n| --- | --- | --- |\n| id | int8 | 主键，自增，每条评论的唯一标识ID |\n| email\\_name | text | 用户名 |\n| post\\_id | int8 | 每条评论的唯一id |\n| created\\_at | timestamptz | 日期，可为空 |\n\nsql初始化语句\n\n```\ndrop table if EXISTS public.posts;\ndrop table if EXISTS public.likes;\n\ncreate table public.posts (\n  id bigint generated by default as identity primary key,\n  email varchar(255),\n  task text check (char_length(task) > 3),\n  created_at timestamp with time zone default timezone('utc'::text, now()) not null\n);\n\ncreate table public.likes (\n  id bigint generated by default as identity primary key,\n  email_name varchar(255),\n  post_id int not null ,\n  created_at timestamp with time zone default timezone('utc'::text, now()) not null\n);\n```\n\n### 5.注册登录功能 [*link*](#5%e6%b3%a8%e5%86%8c%e7%99%bb%e5%bd%95%e5%8a%9f%e8%83%bd)\n\n运行项目\n\n```\nnpm install\n\nnpm run serve\n```\n\n![](../../../img/样例-posts-4.png)\n\n注册、登录、退出登录等功能在vue3-todo-list里已经实现，我们不必再次写一遍，也不需要修改文件里面的代码。\n\n原理\n\n打开Posts/src/compinents/Auth.vue\n\n应用的登录、注册、退出登录的逻辑和页面在这里。登录、注册、退出登录都是通过引入的Posts/src/vuetils/useAuth.ts文件里面的相应功能的api来进行交互的，supabase官网提供的todo-list应用的demo已经在useAuth.ts文件里给我们写好了这些功能的接口。\n\n在Posts/src/vuetils/useAuth.ts文件中看到，在引入supabase依赖之后，我们的登录、注册等功能的api都是由supabase规定熟成的api名称，比如登录叫supabase.auth.signIn，注册叫supabase.auth.signUp。具体[查看文档](https://docs.memfiredb.com/base/javascript/auth-signup.html)\n\n我们来创建一个用户并且尝试登录\n\n控制台显示注册并登录成功，并且已经将我们的用户信息存入了userSession中\n\n![](../../../img/样例-posts-5.png)\n\n### 6.实现发布评论功能 [*link*](#6%e5%ae%9e%e7%8e%b0%e5%8f%91%e5%b8%83%e8%af%84%e8%ae%ba%e5%8a%9f%e8%83%bd)\n\n（1）修改数据类型（ts语法用到数据类型校验）\n\n打开Posts/src/types/global.ts修改为\n\n```\ndeclare interface Credentials {\n  email?: string | undefined\n  password?: string | undefined\n  provider?: 'bitbucket' | 'github' | 'gitlab' | 'google' | undefined\n}\n\ndeclare interface Todo {\n  id?: number\n  email?: string\n  task: string\n  inserted_at?: string\n}\n```\n\n（2）编写页面逻辑\n\n1.打开Posts/src/compinents/TodoList.vue\n\n2.修改页面样式，用户名这里我们使用邮箱“@”符号之前的字符串。\n\n修改template页面为\n\n```\n<template>\n  <div class=\"w-full\">\n    <h2 class=\"mb-12 font-bold text-3xl\">Write a new post</h2>\n    <h2 class=\"mb-12 font-bold text-2xl\">welcome { {userSession.user.email.substring(0,userSession.user.email.indexOf('@'))} }!</h2>\n    <div class=\"flex gap-2 my-2\">\n      <input\n        v-model=\"task\"\n        class=\"rounded w-full p-2\"\n        type=\"text\"\n        placeholder=\"What do you need to?\"\n      />\n      <button @click=\"insertTask\" class=\"btn-black\">\n        Publish\n      </button>\n    </div>\n\n    <div class=\"bg-white shadow overflow-hidden rounded-md\" style=\"height: 300px;overflow-y: scroll;\">\n      <ul v-for=\"(todo, index) in allTodos\" :key=\"index\">\n        <suspense>\n        <Todo :todo=\"todo\" />\n        </suspense>\n      </ul>\n    </div>\n  </div>\n</template>\n```\n\n3.在该页面搜索insertTask方法，这是发布的按钮，将发布论坛评论方法的参数改为email和task\n\n```\nconst todo = await addTodo({ email: userSession.value.user.email, task: task.value})\n```\n\n下图就是登录后修改的posts首页\n\n![](../../../img/样例-posts-6.png)\n\n页面引入的Posts/src/vuetils/useTodo.ts文件是用来请求posts列表数据和新增一条post相应功能交互的api的方法\n\n打开Posts/src/vuetils/useTodo.ts文件\n\n由于我们修改了表名称，但是逻辑并没有修改，只需要替换查询表名，所以我们将fetchTodos方法里面的查询posts列表语法修改为\n\n```\nconst { data: todos, error } = await supabase.from('posts').select('*').order('id')\n```\n\n同上，我们将addTodo里面的新增post语法改为\n\n```\nconst { data, error } = await supabase.from('posts').insert(todo).single()\n```\n\n现在我们在页面插入一条数据，观察控制台的network的接口请求情况，显示插入成功\n\n### 7.渲染评论列表和点赞功能 [*link*](#7%e6%b8%b2%e6%9f%93%e8%af%84%e8%ae%ba%e5%88%97%e8%a1%a8%e5%92%8c%e7%82%b9%e8%b5%9e%e5%8a%9f%e8%83%bd)\n\n打开Posts/src/components/Todo.vue页面，我们要先把页面样式做以下修改\n\n**Template**\n\n```\n<template>\n  <li\n    class=\"\n      block\n      cursor-pointer\n      hover:bg-gray-200\n      focus:outline-none focus:bg-gray-200\n      transition\n      duration-150\n      ease-in-out\n      border-style1\n    \"\n  >\n    <div class=\"flex items-center px-4 py-4 sm:px-6\">\n      <div class=\"min-w-0 flex-1 flex items-center\">\n        <div class=\"text-sm leading-5 font-medium truncate t-s\">{ { todo.task } }</div>\n      </div>\n      <button @click=\"toggleLike\" class=\"w-4 h-4 ml-2  hover:border-black rounded\">\n        <svg\n          v-if=\"like\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n          width=\"24px\"\n          height=\"24px\"\n          preserveAspectRatio=\"xMidYMid meet\"\n          viewBox=\"0 0 256 256\"\n        >\n          <path\n            d=\"M236.023 92c0 30.565-17.713 62.005-52.648 93.446a317.34 317.34 0 0 1-51.442 37.534a8 8 0 0 1-7.819 0c-4.25-2.38-104.09-59.117-104.09-130.98a60.02 60.02 0 0 1 108-36.04a60.02 60.02 0 0 1 108 36.04z\"\n            fill=\"currentColor\"\n          ></path>\n        </svg>\n        <svg\n          v-else\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n          width=\"24px\"\n          height=\"24px\"\n          preserveAspectRatio=\"xMidYMid meet\"\n          viewBox=\"0 0 256 256\"\n        >\n          <path\n            d=\"M128.018 228a11.995 11.995 0 0 1-5.864-1.53C117.82 224.043 16.018 166.18 16.018 92a64.028 64.028 0 0 1 112-42.378a64.028 64.028 0 0 1 112 42.378c0 74.18-101.803 132.043-106.137 134.47a11.995 11.995 0 0 1-5.863 1.53zm-48-176a40.046 40.046 0 0 0-40 40c0 51.222 67.445 97.186 88 110c20.554-12.814 88-58.778 88-110a40.009 40.009 0 0 0-76.928-15.408a12 12 0 0 1-22.145 0A39.923 39.923 0 0 0 80.018 52z\"\n            fill=\"currentColor\"\n          ></path>\n        </svg>\n      </button>\n    </div>\n    <div class=\"flex items-center px-4 py-4 sm:px-6 t-m\">\n      { {todo.email.substring(0, todo.email.indexOf('@'))} }\n    </div>\n  </li>\n</template>\n```\n\n**Css**\n\n```\n<style lang=\"css\" scoped>\n.border-style1 {\n  border: 1px solid #d5d0d0;\n  margin: 20px 15px;\n  border-radius: 10px;\n}\n.t-s {\n  font-size: 14px;\n  font-weight: bold;\n}\n.t-m {\n  font-size: 13px;\n  font-weight: normal;\n  margin-top: -20px;\n}\n</style>\n```\n\n在Todo.vue列表组件中，我们需要展示所有用户的评论、用户名、当前用户是否点赞，列表的数据我们已经在TodoList.vue的fetchTodos方法中拿到，并且传递给了Todo.vue子组件。接下来我们编写点赞接口的逻辑。\n\n刷新点赞方法：\n\n原理：likes表里面包含所有当前用户的点赞数据，是通过当前用户的用户名email与遍历当前一条数据的post的id与likes表里面的email\\_name和post\\_id是否匹配进行查询，这是一个组件的循环遍历查询，每查一次，看是否查到数据，查到数据则表示该用户给当前的评论点了赞，即为带有当前用户点赞的数据，有的话将当前一条数据的like改为有数据即为true，爱心点亮\n\n步骤：\n\n1.在Todo.vue引入文件\n\n```\nimport { defineComponent, ref } from 'vue'\n\nimport { supabase } from '@/lib/supabase'\n\nimport { userSession } from '@/vuetils/useAuth'\n```\n\n2.将Todo.vue逻辑代码都清空，加上下面的刷新点赞的方法\n\n```\nconst fecthLike = async () => {\n    const { data } = await supabase\n      .from('likes')\n      .select('*')\n      .match({\n        post_id: props.todo.id,\n        email_name: userSession?.value?.user?.email || '',\n      })\n      if(data?.length){\n        like.value = data[0]\n      } else {\n          like.value = null\n      }\n}\n```\n\n切换点赞的方法：\n\n每次切换完都要刷新一下点赞\n\n原理：\n\n点赞就在likes表里添加一条用户用户名email\\_name和post\\_id的数据，取消点赞就删除此条数据\n\n3.增加以下代码\n\n```\nconst toggleLike = async () => {\n    if (like.value) {\n      await supabase\n        .from('likes')\n        .delete()\n        .match({\n          post_id: props.todo.id,\n          email_name: userSession?.value?.user?.email || '',\n        })\n    } else {\n      await supabase\n        .from('likes')\n        .insert({\n          post_id: props.todo.id,\n          email_name: userSession?.value?.user?.email,\n        })\n        .single()\n    }\n  fecthLike()\n  }\n```\n\nTodo.vue完整代码\n\n```\n<template>\n  <li\n    class=\"\n      block\n      cursor-pointer\n      hover:bg-gray-200\n      focus:outline-none focus:bg-gray-200\n      transition\n      duration-150\n      ease-in-out\n      border-style1\n    \"\n  >\n    <div class=\"flex items-center px-4 py-4 sm:px-6\">\n      <div class=\"min-w-0 flex-1 flex items-center\">\n        <div class=\"text-sm leading-5 font-medium truncate t-s\">{{ todo.task }}</div>\n      </div>\n      <button @click=\"toggleLike\" class=\"w-4 h-4 ml-2  hover:border-black rounded\">\n        <svg\n          v-if=\"like\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n          width=\"24px\"\n          height=\"24px\"\n          preserveAspectRatio=\"xMidYMid meet\"\n          viewBox=\"0 0 256 256\"\n        >\n          <path\n            d=\"M236.023 92c0 30.565-17.713 62.005-52.648 93.446a317.34 317.34 0 0 1-51.442 37.534a8 8 0 0 1-7.819 0c-4.25-2.38-104.09-59.117-104.09-130.98a60.02 60.02 0 0 1 108-36.04a60.02 60.02 0 0 1 108 36.04z\"\n            fill=\"currentColor\"\n          ></path>\n        </svg>\n        <svg\n          v-else\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n          width=\"24px\"\n          height=\"24px\"\n          preserveAspectRatio=\"xMidYMid meet\"\n          viewBox=\"0 0 256 256\"\n        >\n          <path\n            d=\"M128.018 228a11.995 11.995 0 0 1-5.864-1.53C117.82 224.043 16.018 166.18 16.018 92a64.028 64.028 0 0 1 112-42.378a64.028 64.028 0 0 1 112 42.378c0 74.18-101.803 132.043-106.137 134.47a11.995 11.995 0 0 1-5.863 1.53zm-48-176a40.046 40.046 0 0 0-40 40c0 51.222 67.445 97.186 88 110c20.554-12.814 88-58.778 88-110a40.009 40.009 0 0 0-76.928-15.408a12 12 0 0 1-22.145 0A39.923 39.923 0 0 0 80.018 52z\"\n            fill=\"currentColor\"\n          ></path>\n        </svg>\n      </button>\n    </div>\n    <div class=\"flex items-center px-4 py-4 sm:px-6 t-m\">\n      { {todo.email.substring(0, todo.email.indexOf('@'))} }\n    </div>\n  </li>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType, ref } from 'vue'\n/* eslint-disable @typescript-eslint/camelcase */\nimport { supabase } from '@/lib/supabase'\nimport { userSession } from '@/vuetils/useAuth'\n\nexport default defineComponent({\n  name: 'Todo',\n  props: {\n    todo: {\n      type: Object,\n      required: true,\n    },\n  },\n  setup(props) {\n    const like = ref<undefined | null>(undefined)\n    const fecthLike = async () => {\n      const { data } = await supabase\n        .from('likes')\n        .select('*')\n        .match({\n          post_id: props.todo.id,\n          email_name: userSession?.value?.user?.email || '',\n        })\n        if(data?.length){\n          like.value = data[0]\n        } else {\n            like.value = null\n        }\n  }\n    fecthLike()\n    // Removes todo from supbase and also from app state\n    const toggleLike = async () => {\n      if (like.value) {\n        await supabase\n          .from('likes')\n          .delete()\n          .match({\n            post_id: props.todo.id,\n            email_name: userSession?.value?.user?.email || '',\n          })\n      } else {\n        await supabase\n          .from('likes')\n          .insert({\n            post_id: props.todo.id,\n            email_name: userSession?.value?.user?.email,\n          })\n          .single()\n      }\n    fecthLike()\n    }\n\n    return { toggleLike, userSession,like,fecthLike }\n  },\n\n})\n</script>\n\n<style lang=\"css\" scoped>\n.border-style1 {\n  border: 1px solid #d5d0d0;\n  margin: 20px 15px;\n  border-radius: 10px;\n}\n.t-s {\n  font-size: 14px;\n  font-weight: bold;\n}\n.t-m {\n  font-size: 13px;\n  font-weight: normal;\n  margin-top: -20px;\n}\n</style>\n```\n\n小技巧：\n\n具体的增删改查的语法可以参考[文档](https://docs.memfiredb.com/base/javascript/select.html)\n\n重启一下项目，登录后我们来新增一条数据，新增成功，点赞也成功了！\n\n![](../../../img/样例-posts-7.png)\n\n简单的post应用即完成！\n\n### 写在结尾的话 [*link*](#%e5%86%99%e5%9c%a8%e7%bb%93%e5%b0%be%e7%9a%84%e8%af%9d)\n\n以上就是基于一个教程示例对MemFire Cloud的使用和反馈的一些看法，如果在开发中遇到问题，可以参考上面的完整代码项目比对，希望对大家有所帮助。\n\n---\n\n[*navigate\\_before* 微信小程序聊天室](/docs/app/example/wechat/wechatroom/)\n\n[实时游戏场 *navigate\\_next*](/docs/app/example/web/playground/)"
}